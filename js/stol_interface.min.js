var detectMetamask=!1,metamaskConnected=!1,userAddress="",refreshTimer=null,airdropInfo={},targetNetwork=1,wethAddress="0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",stakerAddress="0x4d44545cB6AE1f0Efb972be59379c5ae406E676C",claimerAddress="0x71Ce0fb59f17894A70f1D1b4F6eb03cA93E96858",merkleAddress="0xd55bf7FDa184233063C8E3e835bfe39E1A179919",stbzAddress="0xB987D48Ed8f2C468D52D6405624EADBa5e76d723",stolLpAddress="0xbd13D3297570885ED73eE93D3e929fE1e5b233f0",oracleAddress="0xEb0Bc43490E1EC029174F5809A783f7b59457a71",minHoursClaimTime=72,minSTBZAmount=50,minHoursLPLocked=24,maxPercentClaim=new BigNumber(.04),contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_stolusd="61599737",contract_ethusd="96c38294",contract_claim="4e71d92d",contract_getethbalance="3bb66a7b",contract_getclaimtime="a680e0bc",contract_getminstake="a50fdbb1",contract_getdeposittime="85b622a6",contract_lpbalance="d2258beb",contract_stbzbalance="4d45c3f3",contract_stolinlp="30062ae2",contract_stakestbz="c773bffb",contract_stakelp="7069508a",contract_unstakestbz="835fe8bf",contract_unstakelp="c4778998",contract_updatebalance="26c016e5",contract_isclaimed="9e34070f",contract_merkleclaim="2e7ba6ef";function checkMetaMaskExist(){void 0!==window.ethereum&&(1==ethereum.isMetaMask&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect MetaMask"):0==metamaskConnected&&enableMetaMask()))}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){if(ethereum.chainId||(ethereum.chainId="0x1"),0!=new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork))return void alert("This application requires the main network, please switch it in your MetaMask UI.");userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),updateUI(),checkMerkleAirdrop(),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function checkMerkleAirdrop(){$.getJSON("stol_airdrop_merkle.json",function(e){$.each(e.claims,function(t,r){e.claims[t.toLowerCase()]||(e.claims[t.toLowerCase()]=r,delete e.claims[t])});var t=userAddress.toLowerCase();if(!e.claims[t])return;var r=new BigNumber(e.claims[t].index).toString(16);r=padleftzero(r,64);const a=[{to:merkleAddress,data:"0x"+contract_isclaimed+r},"latest"];ethereum.request({method:"eth_call",params:a}).then(r=>{var a=r.substring(2);0==new BigNumber("0x"+a.substring(0,64)).comparedTo(0)&&(airdropInfo.index=e.claims[t].index,airdropInfo.amount=new BigNumber("0x"+e.claims[t].amount),airdropInfo.proof=e.claims[t].proof,$("#airdrop_action").html("CLAIM "+airdropInfo.amount.div(new BigNumber(10).pow(18)).dp(2)+" STOL FROM STABINOL AIRDROP NOW >"),$("#airdrop_action").css("display","inline"))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})})}function getSTOLAirdrop(){if(!airdropInfo)return;var e=airdropInfo.index.toString(16);e=padleftzero(e,64);var t=padleftzero(userAddress.substring(2),64),r=airdropInfo.amount.toString(16);r=padleftzero(r,64);var a=new BigNumber(128).toString(16);a=padleftzero(a,64);var n=new BigNumber(airdropInfo.proof.length).toString(16);n=padleftzero(n,64);for(var s="",o=0;o<airdropInfo.proof.length;o++)s+=padrightzero(airdropInfo.proof[o].substring(2),64);sendETHTransaction([{to:merkleAddress,from:userAddress,data:"0x"+contract_merkleclaim+e+t+r+a+n+s}],function(){$("#airdrop_action").css("display","none")})}async function updateUI(){null!=refreshTimer&&clearTimeout(refreshTimer),refreshTimer=window.setTimeout(updateUI,6e4);var e=new BigNumber(0),t=new BigNumber(0),r=[{to:oracleAddress,data:"0x"+contract_stolusd},"latest"];await ethereum.request({method:"eth_call",params:r}).then(t=>{var r=t.substring(2);e=(e=new BigNumber("0x"+r.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),r=[{to:oracleAddress,data:"0x"+contract_ethusd},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var r=e.substring(2);t=(t=new BigNumber("0x"+r.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var a=padleftzero(userAddress.substring(2),64),n=new BigNumber(0);r=[{to:claimerAddress,data:"0x"+contract_getethbalance+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);n=(n=new BigNumber("0x"+t.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});new BigNumber(0);r=[{to:claimerAddress,data:"0x"+contract_getminstake},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);new BigNumber("0x"+t.substring(0,64)).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var s=new BigNumber(0);r=[{to:claimerAddress,data:"0x"+contract_getclaimtime+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);s=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var o=new BigNumber(0);r=[{to:stakerAddress,data:"0x"+contract_stbzbalance+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);o=(o=new BigNumber("0x"+t.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var i=new BigNumber(0);r=[{to:stakerAddress,data:"0x"+contract_lpbalance+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);i=(i=new BigNumber("0x"+t.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var c=new BigNumber(0);r=[{to:stakerAddress,data:"0x"+contract_stolinlp+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);c=(c=new BigNumber("0x"+t.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var l=new BigNumber(0);r=[{to:stakerAddress,data:"0x"+contract_getdeposittime+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);l=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var d=new BigNumber(0);r=[{to:wethAddress,data:"0x"+contract_balanceof+a},"latest"],await ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);d=(d=new BigNumber("0x"+t.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),r=[userAddress,"latest"],await ethereum.request({method:"eth_getBalance",params:r}).then(e=>{var t=e.substring(2),r=new BigNumber("0x"+t.substring(0,64));r=r.div(new BigNumber(10).pow(18)),d=d.plus(r)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var u=Math.floor((new Date).getTime()/1e3),m=0;if(l.comparedTo(0)>0){var g=u-parseInt(l.toString(10)),h=Math.floor(g/3600),b=Math.floor(g%3600/60),p="HRS";1==h&&(p="HR"),h>0?$("#last_deposit_time").html(h+" "+p+" AGO"):$("#last_deposit_time").html(b+" MINS AGO"),h<minHoursClaimTime&&(m=1)}else $("#last_deposit_time").html("NO DEPOSIT"),m=2;if(s.comparedTo(0)>0){g=u-parseInt(s.toString(10)),h=Math.floor(g/3600),b=Math.floor(g%3600/60),p="HRS";1==h&&(p="HR"),h>0?$("#last_claim_time").html(h+" "+p+" AGO"):$("#last_claim_time").html(b+" MINS AGO"),h<minHoursClaimTime&&(m=1),h<minHoursLPLocked?0==$("#lp_withdraw_button").prop("disabled")&&($("#lp_withdraw_button").prop("disabled",!0),$("#lp_withdraw_button").html("24 HR LOCK")):1==$("#lp_withdraw_button").prop("disabled")&&($("#lp_withdraw_button").prop("disabled",!1),$("#lp_withdraw_button").html("WITHDRAW >"))}else $("#last_claim_time").html("NO CLAIMS YET");0==i.comparedTo(0)&&(m=5),o.comparedTo(minSTBZAmount)<0?($("#staked_stbz_amount").html(o.dp(2).toString(10)+"/"+minSTBZAmount.toString(10)+" STBZ"),$("#staked_stbz_amount").css("color","rgb(200,40,40)"),$("#stbz_stake_button").html("STAKE STBZ >"),m=3):($("#staked_stbz_amount").html(o.dp(2).toString(10)+"/"+minSTBZAmount.toString(10)+" STBZ"),$("#staked_stbz_amount").css("color","rgb(40,200,40)"),$("#stbz_stake_button").html("WITHDRAW STBZ >")),$("#staked_lp_amount").html(i.dp(8).toString(10)+" LP"),$("#eth_bal").html(n.dp(8).toString(10)+" ETH"),l.comparedTo(0)>0&&(n.comparedTo(d)<0?("none"==$("#update_action").css("display")&&$("#update_action").css("display","inline"),0==m&&(m=4)):"none"!=$("#update_action").css("display")&&$("#update_action").css("display","none"));var _=c.times(e);if($("#stol_value").html("$"+_.toFormat(2)),$("#claim_button").css("display","none"),3==m)$("#status").html("STAKE REQUIRED STBZ"),$("#status").css("color","rgb(200,40,40)");else if(5==m||2==m)$("#status").html("STAKE LP"),$("#status").css("color","rgb(200,40,40)");else if(1==m)$("#status").html("TOO SOON TO CLAIM"),$("#status").css("color","rgb(200,40,40)");else if(4==m)$("#status").html("UPDATE LAST ETH BALANCE"),$("#status").css("color","rgb(200,40,40)");else if(0==m&&n.comparedTo(d)>0){var f=_.times(maxPercentClaim),w=n.minus(d).times(t);if(w.comparedTo(f)>0&&(w=f),e.comparedTo(0)>0){var k=w.div(e);$("#status").html("CLAIM "+k.dp(2)+" STOL"),$("#status").css("color","rgb(40,200,40)"),$("#claim_button").css("display","inline-block")}}checkAllowance()}function checkAllowance(){var e=padleftzero(userAddress.substring(2),64),t=padleftzero(stakerAddress.substring(2),64);if("none"==$("#stbz_action_button").css("display")&&"none"==$("#stbz_unlock_button_div").css("display")||1==$("#stbz_unlock_inner_button").prop("disabled")){const r=[{to:stbzAddress,data:"0x"+contract_viewallowance+e+t},"latest"];ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);new BigNumber("0x"+t.substring(0,64)).comparedTo(1)<0?$("#stbz_unlock_button_div").show():($("#stbz_unlock_button_div").hide(),$("#stbz_action_button").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}if("none"==$("#stol_lp_action_buttons").css("display")&&"none"==$("#stol_lp_unlock_button_div").css("display")||1==$("#stol_lp_unlock_inner_button").prop("disabled")){const r=[{to:stolLpAddress,data:"0x"+contract_viewallowance+e+t},"latest"];ethereum.request({method:"eth_call",params:r}).then(e=>{var t=e.substring(2);new BigNumber("0x"+t.substring(0,64)).comparedTo(1)<0?$("#stol_lp_unlock_button_div").show():($("#stol_lp_unlock_button_div").hide(),$("#stol_lp_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}}function unlockToken(e,t){var r=new BigNumber(2).pow(256).minus(1),a=stakerAddress.substring(2);a=padleftzero(a.toLowerCase(),64);var n=r.toString(16);n=padleftzero(n,64);var s=stbzAddress;1==e&&(s=stolLpAddress),sendETHTransaction([{to:s,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+a+n}],function(){$(t).prop("disabled",!0),$(t).html("UNLOCKING...")})}function selectMaxLPIn(){var e=padleftzero(userAddress.substring(2),64);const t=[{to:stolLpAddress,data:"0x"+contract_balanceof+e},"latest"];ethereum.request({method:"eth_call",params:t}).then(e=>{var t=e.substring(2),r=new BigNumber("0x"+t.substring(0,64));r=r.div(new BigNumber(10).pow(18)),$("#lp_amount").val(r.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxLPOut(){var e=padleftzero(userAddress.substring(2),64);const t=[{to:stakerAddress,data:"0x"+contract_lpbalance+e},"latest"];ethereum.request({method:"eth_call",params:t}).then(e=>{var t=e.substring(2),r=new BigNumber("0x"+t.substring(0,64));r=r.div(new BigNumber(10).pow(18)),$("#lp_amount").val(r.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function claimSTOL(){sendETHTransaction([{to:claimerAddress,from:userAddress,data:"0x"+contract_claim}],function(){$("#claim_button").css("display","none")})}function updateBalance(){sendETHTransaction([{to:stakerAddress,from:userAddress,data:"0x"+contract_updatebalance}],function(){$("#update_action").css("display","none")})}function stakeSTBZAction(){var e=0;$("#stbz_stake_button").html().indexOf("WITHDRAW")>-1&&(e=1),sendETHTransaction(0==e?[{to:stakerAddress,from:userAddress,data:"0x"+contract_stakestbz}]:[{to:stakerAddress,from:userAddress,data:"0x"+contract_unstakestbz}],null)}function stakeLP(){var e=new BigNumber($("#lp_amount").val());if(e.isNaN())return;if(e.comparedTo(0)<=0)return;var t=(e=e.times(new BigNumber(10).pow(18))).toString(16);t=padleftzero(t,64),sendETHTransaction([{to:stakerAddress,from:userAddress,data:"0x"+contract_stakelp+t}],null)}function unstakeLP(){var e=new BigNumber($("#lp_amount").val());if(e.isNaN())return;if(e.comparedTo(0)<=0)return;var t=(e=e.times(new BigNumber(10).pow(18))).toString(16);t=padleftzero(t,64),sendETHTransaction([{to:stakerAddress,from:userAddress,data:"0x"+contract_unstakelp+t}],null)}function sendETHTransaction(e,t){0==new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,r){var a="";if(r>0){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3),a="; expires="+n.toUTCString()}document.cookie=e+"="+(t||"")+a+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",r=document.cookie.split(";"),a=0;a<r.length;a++){for(var n=r[a];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});