var detectMetamask=!1,metamaskConnected=!1,userAddress="",refreshTimer=null,priceQuoteTimer=null,sendAmountTimer=null,searchTokenTimer=null,allowanceTimer=null,tokenList=[],tokenDirection=0,wethAddress="0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",ethAddress="0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",routerAddress="0x90d60BE875b526de78dD5E2Db3A5bfA34F6a6649",claimStakerAddress="0x1775e656eBEA1Df63a0999f9EBF78fbd5EBc17e4",reethFee=new BigNumber(.003),sendTokenAddress=ethAddress.toUpperCase(),receiveTokenAddress="",maxSlippage=new BigNumber(.5),deadlineTime=new BigNumber(20),swapData={sendAmount:0,feeAmount:0,priceRoute:null,sendDecimals:0,receiveDecimals:0,minReceiveAmount:0},targetNetwork=1,contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_decimals="313ce567",contract_token_name="06fdde03",contract_token_symbol="95d89b41",contract_weth_deposit="d0e30db0",contract_weth_withdraw="2e1a7d4d",contract_query_fee="761f10c5",contract_swap_tokens="556fbe85",contract_getuserethspent="f5271146";function loadInitialTokens(){tokenList.push({address:"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",symbol:"ETH",descript:"ETHEREUM",safe:!0,hidden:!1}),tokenList.push({address:"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",symbol:"WETH",descript:"WRAPPED ETHEREUM",safe:!0,hidden:!1}),tokenList.push({address:"0xB987D48Ed8f2C468D52D6405624EADBa5e76d723",symbol:"STBZ",descript:"STABILIZE",safe:!0,hidden:!1}),tokenList.push({address:"0xe804964c296E9FB666fBE67767838c1FF9Ab3209",symbol:"REETH",descript:"REETH TOKEN",safe:!0,hidden:!1}),tokenList.push({address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",symbol:"USDC",descript:"USD COIN",safe:!0,hidden:!1}),tokenList.push({address:"0xdAC17F958D2ee523a2206206994597C13D831ec7",symbol:"USDT",descript:"TETHER COIN",safe:!0,hidden:!1}),tokenList.push({address:"0x6B175474E89094C44Da98b954EedeAC495271d0F",symbol:"DAI",descript:"MAKERDAO DAI",safe:!0,hidden:!1}),tokenList.push({address:"0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",symbol:"WBTC",descript:"WRAPPED BITCOIN",safe:!0,hidden:!1}),tokenList.push({address:"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",symbol:"UNI",descript:"UNISWAP COIN",safe:!0,hidden:!1}),tokenList.push({address:"0x514910771AF9Ca656af840dff83E8264EcF986CA",symbol:"LINK",descript:"CHAINLINK",safe:!0,hidden:!1}),tokenList.push({address:"0x8E870D67F660D95d5be530380D0eC0bd388289E1",symbol:"PAX",descript:"PAXOS STANDARD",safe:!0,hidden:!1}),tokenList.push({address:"0x9f8F72aA9304c8B593d555F12eF6589cC3A579A2",symbol:"MKR",descript:"MAKERDAO TOKEN",safe:!0,hidden:!1}),tokenList.push({address:"0xa47c8bf37f92aBed4A126BDA807A7b7498661acD",symbol:"UST",descript:"LUNA UST",safe:!0,hidden:!1}),tokenList.push({address:"0x853d955aCEf822Db058eb8505911ED77F175b99e",symbol:"FRAX",descript:"FRAX",safe:!0,hidden:!1}),tokenList.push({address:"0x7Fc66500c84A76Ad7e9c93437bFc5Ac33E2DDaE9",symbol:"AAVE",descript:"AAVE TOKEN",safe:!0,hidden:!1}),tokenList.push({address:"0xEB4C2781e4ebA804CE9a9803C67d0893436bB27D",symbol:"RENBTC",descript:"RENBTC",safe:!0,hidden:!1})}function checkMetaMaskExist(){void 0!==window.ethereum&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect Wallet"):0==metamaskConnected&&enableMetaMask())}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){var t=await ethereum.request({method:"eth_chainId"});if(0!=(t=new BigNumber("0x"+t.substring(2))).comparedTo(targetNetwork))return void(0==t.comparedTo(56)?window.location.replace("../../"):alert("This application requires the ETH network, please switch it in your MetaMask UI."));userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),$("#max_slippage_inner").html(maxSlippage.dp(2).toString(10)),updateUI(),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function openOptionsModal(){$("#modal_options_slippage").val(maxSlippage.dp(2).toString(10)),$("#modal_options_deadline").val(deadlineTime),$("#optionsModal").modal({})}function saveAndCloseOptionsModal(){maxSlippage=new BigNumber($("#modal_options_slippage").val()),deadlineTime=new BigNumber($("#modal_options_deadline").val()),$("#max_slippage_inner").html(maxSlippage.dp(2).toString(10)),$("#optionsModal").modal("hide")}function openTokenSearch(e){tokenDirection=e,0==tokenList.length&&(loadInitialTokens(),populateInitialTokens()),$("#token_search_box").val("");for(var t=0;t<tokenList.length;t++){var a="#modal_token_"+tokenList[t].address;1==tokenList[t].hidden&&($(a).show(),tokenList[t].hidden=!1),$("#modal_token_"+tokenList[t].address+"_balance").html("-")}$("#tokenModal").modal({}),populateTokenBalances()}function populateInitialTokens(){for(var e=0;e<tokenList.length;e++)addTokenToList(e)}function addTokenToList(e){var t=tokenList[e].symbol,a=tokenList[e].descript,n=tokenList[e].address,o=tokenList[e].address.substring(0,9)+"..."+tokenList[e].address.substring(33);tokenList[e].address.toUpperCase()==ethAddress.toUpperCase()&&(o="");var s="";0==tokenList[e].safe&&(s="color: red;"),$("#token_list").append('<div id="modal_token_'+n+'" class="token_list_row" onclick="selectToken(this);"><div class="token_list_left_item"><span style="font-size: 20px; font-weight: bold; '+s+'">'+t+"</span><br>"+a+"<br>"+o+'</div><div class="token_list_right_item"><span id="modal_token_'+n+'_balance">-</span></div></div>')}function selectToken(e){var t=$(e).attr("id");t=(t=t.substring(12)).toUpperCase();for(var a=-1,n=0;n<tokenList.length;n++){if(t==tokenList[n].address.toUpperCase()){a=n;break}}if($("#tokenModal").modal("hide"),-1!=a){var o=tokenList[a].address.toUpperCase();if(0==tokenDirection){if(receiveTokenAddress==o)return void inverseTokens();sendTokenAddress=o,$("#send_token_symbol").html(tokenList[a].symbol)}else{if(sendTokenAddress==o)return void inverseTokens();""==receiveTokenAddress&&$("#swap_action_button").html("SELECT SWAP AMOUNT"),receiveTokenAddress=o,$("#receive_token_symbol").html(tokenList[a].symbol)}resetAmountCalculation(),updateUI()}}function resetTokenSearch(){null!=searchTokenTimer&&clearTimeout(searchTokenTimer),searchTokenTimer=window.setTimeout(checkTokenSearch,250)}async function checkTokenSearch(){var e=$("#token_search_box").val();if(e.length<3){for(var t=0;t<tokenList.length;t++)if(1==tokenList[t].hidden){var a="#modal_token_"+tokenList[t].address;$(a).show(),tokenList[t].hidden=!1}}else{var n=!1;e=e.toLowerCase();for(t=0;t<tokenList.length;t++){var o=tokenList[t].address.toLowerCase(),s=tokenList[t].descript.toLowerCase(),r=tokenList[t].symbol.toLowerCase();if(o.indexOf(e)<0&&s.indexOf(e)<0&&r.indexOf(e)<0){a="#modal_token_"+tokenList[t].address;$(a).hide(),tokenList[t].hidden=!0}else{a="#modal_token_"+tokenList[t].address;"none"==$(a).css("display")&&$(a).show(),tokenList[t].hidden=!1,n=!0}}0==n&&42==e.length&&"0x"==e.substring(0,2).toLowerCase()&&await importNewToken(e),populateTokenBalances()}}async function populateTokenBalances(){for(var e=0,t=0;t<tokenList.length;t++){if(0==tokenList[t].hidden){if("-"==$("#modal_token_"+tokenList[t].address+"_balance").html()){var a=await getTokenBalance(tokenList[t].address);$("#modal_token_"+tokenList[t].address+"_balance").html(a.dp(8).toString(10))}e++}if(e>4)break}}async function importNewToken(e){var t="",a=[{to:e.toLowerCase(),data:"0x"+contract_token_name},"latest"];if(await ethereum.request({method:"eth_call",params:a}).then(e=>{var a=e.substring(2);if(0!=a.length){var n=new BigNumber("0x"+a.substring(64,128)),o=a.substring(128,128+2*parseInt(n.toString(10)));o=hex2ascii(o),t=o.toUpperCase()}}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0!=t.length){var n="";a=[{to:e.toLowerCase(),data:"0x"+contract_token_symbol},"latest"],await ethereum.request({method:"eth_call",params:a}).then(e=>{var t=e.substring(2);if(0!=t.length){var a=new BigNumber("0x"+t.substring(64,128)),o=t.substring(128,128+2*parseInt(a.toString(10)));o=hex2ascii(o),n=o.toUpperCase()}}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0!=n.length&&(tokenList.push({address:e,symbol:n,descript:t+" (IMPORTED)",safe:!1,hidden:!1}),addTokenToList(tokenList.length-1))}}function hex2ascii(e){for(var t=e.toString(),a="",n=0;n<t.length;n+=2)a+=String.fromCharCode(parseInt(t.substr(n,2),16));return a}function inverseTokens(){if(""!=receiveTokenAddress){var e=receiveTokenAddress,t=$("#receive_amount").val();receiveTokenAddress=sendTokenAddress,$("#receive_amount").val($("#send_amount").val()),sendTokenAddress=e,$("#send_amount").val(t);for(var a=0;a<tokenList.length;a++){var n=tokenList[a].address.toUpperCase();n==sendTokenAddress&&$("#send_token_symbol").html(tokenList[a].symbol),n==receiveTokenAddress&&$("#receive_token_symbol").html(tokenList[a].symbol)}resetAmountCalculation(),checkActiveBalances()}}function resetAmountCalculation(){null!=sendAmountTimer&&clearTimeout(sendAmountTimer),$("#swap_action_button").css("opacity","0.7"),$("#swap_action_button").prop("disabled",!0),""==receiveTokenAddress?$("#swap_action_button").html("SELECT TOKENS"):$("#swap_action_button").html("SELECT SWAP AMOUNT"),sendAmountTimer=window.setTimeout(checkSendAmount,1e3)}async function checkSendAmount(){var e=$("#swap_action_button").html();if("MAKING SWAP..."!=e&&"UNLOCKING TOKEN"!=e){var t=new BigNumber($("#send_amount").val());$("#receive_amount").html(""),t.isNaN()||(0!=t.comparedTo(0)?""!=receiveTokenAddress&&($("#swap_action_button").html("SELECT SWAP AMOUNT"),$("#swap_action_button").css("opacity","0.7"),$("#swap_action_button").prop("disabled",!0),receiveTokenAddress==wethAddress.toUpperCase()&&sendTokenAddress==ethAddress.toUpperCase()?($("#receive_amount").val(t.toString(10)),$("#swap_action_button").html("WRAP ETH"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1)):receiveTokenAddress==ethAddress.toUpperCase()&&sendTokenAddress==wethAddress.toUpperCase()?($("#receive_amount").val(t.toString(10)),$("#swap_action_button").html("UNWRAP ETH"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1)):($("#swap_action_button").html("CALCULATING ROUTE"),await queryParaswap(sendTokenAddress,receiveTokenAddress,t))):$("#receive_amount").val(t.toString(10)))}}async function queryParaswap(e,t,a){var n="https://apiv4.paraswap.io/v2/prices";if(0!=(a=await convertFromDecimalFormat(e,a)).comparedTo(-1)){var o=await getTokenDecimals(t);if(0!=o.comparedTo(-1)){var s=await getTokenDecimals(e);if(0!=s.comparedTo(-1)){swapData.sendAmount=a,swapData.receiveDecimals=o,swapData.sendDecimals=s,n+="?excludeContractMethods=swapOnUniswap%2CswapOnUniswapFork%2CbuyOnUniswap%2CbuyOnUniswapFork&from="+e.toLowerCase()+"&fromDecimals="+s.toString(10)+"&to="+t.toLowerCase()+"&toDecimals="+o.toString(10)+"&amount="+a.toString(10)+"&side=SELL&network=1";var r=new BigNumber(0);if(await $.ajax({url:n,headers:{"X-Partner":"stabilize"},method:"GET"}).then(e=>{r=new BigNumber(e.priceRoute.destAmount),swapData.minReceiveAmount=r.minus(r.times(maxSlippage.div(100))).dp(0),r=(r=r.minus(r.times(reethFee))).div(new BigNumber(10).pow(o)),$("#receive_amount").val(r.dp(8).toString(10)),swapData.priceRoute=e.priceRoute}).fail((e,t,a)=>{console.log("Failed to find trade route"),$("#swap_action_button").html("NO ROUTE FOUND")}),r.comparedTo(0)>0)0==await checkSendTokenAllowance()?($("#swap_action_button").html("UNLOCK TOKEN"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1)):($("#swap_action_button").html("SWAP TOKENS"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1)),null!=priceQuoteTimer&&clearTimeout(priceQuoteTimer),priceQuoteTimer=window.setTimeout(checkSendAmount,6e4)}}}}async function convertToDecimalFormat(e,t){var a=await getTokenDecimals(e);return 0==a.comparedTo(-1)?new BigNumber(-1):t=t.div(new BigNumber(10).pow(a))}async function convertFromDecimalFormat(e,t){var a=await getTokenDecimals(e);return 0==a.comparedTo(-1)?new BigNumber(-1):t=t.times(new BigNumber(10).pow(a))}async function getTokenDecimals(e){if(e.toUpperCase()==ethAddress.toUpperCase())return new BigNumber(18);var t=[{to:e.toLowerCase(),data:"0x"+contract_decimals},"latest"],a=new BigNumber(0);return await ethereum.request({method:"eth_call",params:t}).then(e=>{var t=e.substring(2);a=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e)),a=new BigNumber(-1)}),a}async function getTokenBalance(e){var t=18,a=new BigNumber(0);if(e.toUpperCase()!=ethAddress.toUpperCase()){if(0==(t=await getTokenDecimals(e)).comparedTo(-1))return new BigNumber(0);var n=padleftzero(userAddress.substring(2),64),o=[{to:e.toLowerCase(),data:"0x"+contract_balanceof+n},"latest"];await ethereum.request({method:"eth_call",params:o}).then(e=>{var t=e.substring(2);a=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}else await ethereum.request({method:"eth_getBalance",params:[userAddress,"latest"]}).then(e=>{var t=e.substring(2);a=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});return a.comparedTo(0)>0&&(a=a.div(new BigNumber(10).pow(t))),a}async function checkActiveBalances(){if(""!=sendTokenAddress){var e=await getTokenBalance(sendTokenAddress);$("#send_balance").html(e.dp(8).toString(10))}if(""!=receiveTokenAddress){var t=await getTokenBalance(receiveTokenAddress);$("#receive_balance").html(t.dp(8).toString(10))}}async function updateUI(){null!=refreshTimer&&clearTimeout(refreshTimer);var e=padleftzero(userAddress.substring(2),64),t=new BigNumber(0),a=[{to:claimStakerAddress,data:"0x"+contract_getuserethspent+e},"latest"];await ethereum.request({method:"eth_call",params:a}).then(e=>{var a=e.substring(2);t=(t=new BigNumber("0x"+a.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),checkActiveBalances();var n=8;t.comparedTo(1)>0&&(n=2),$("#eth_spent").html(t.dp(n).toString(10)+" ETH"),refreshTimer=window.setTimeout(updateUI,15e3)}async function selectMaxSend(){var e=await getTokenBalance(sendTokenAddress);$("#send_amount").val(e),resetAmountCalculation()}async function makeAction(){var e=await getTokenBalance(sendTokenAddress),t=new BigNumber($("#send_amount").val()),a=$("#swap_action_button").html();if("WRAP ETH"==a){if(t.comparedTo(e)>0)return void alert("Cannot send more than your balance");var n=(t=t.times(new BigNumber(10).pow(18))).toString(16);sendETHTransaction([{to:wethAddress.toLowerCase(),value:n,from:userAddress.toLowerCase(),data:"0x"+contract_weth_deposit}],null)}else if("UNWRAP ETH"==a){if(t.comparedTo(e)>0)return void alert("Cannot send more than your balance");n=padleftzero(n=(t=t.times(new BigNumber(10).pow(18))).toString(16),64),sendETHTransaction([{to:wethAddress.toLowerCase(),from:userAddress.toLowerCase(),data:"0x"+contract_weth_withdraw+n}],null)}else if("UNLOCK TOKEN"==a)unlockSendToken();else if("SWAP TOKENS"==a){if(t.comparedTo(e)>0)return void alert("Cannot send more than your balance");swapTokens()}}async function checkSendTokenAllowance(){if(""==sendTokenAddress)return;if(sendTokenAddress==ethAddress.toUpperCase())return!0;var e=padleftzero(userAddress.substring(2),64),t=padleftzero(routerAddress.substring(2),64);const a=[{to:sendTokenAddress.toLowerCase(),data:"0x"+contract_viewallowance+e+t},"latest"];var n=new BigNumber(0);return await ethereum.request({method:"eth_call",params:a}).then(e=>{var t=e.substring(2);n=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),!(n.comparedTo(1)<0)}async function checkAllowanceContinued(){1==await checkSendTokenAllowance()&&($("#swap_action_button").html("SWAP TOKENS"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1)),"UNLOCKING TOKEN"==$("#swap_action_button").html()&&(allowanceTimer=window.setTimeout(checkAllowanceContinued,15e3))}function unlockSendToken(){var e=new BigNumber(2).pow(256).minus(1),t=routerAddress.substring(2);t=padleftzero(t.toLowerCase(),64);var a=e.toString(16);a=padleftzero(a,64),sendETHTransaction([{to:sendTokenAddress.toLowerCase(),from:userAddress.toLowerCase(),data:"0x"+contract_approve+t+a}],function(){$("#swap_action_button").prop("disabled",!0),$("#swap_action_button").css("opacity","0.7"),$("#swap_action_button").html("UNLOCKING TOKEN"),allowanceTimer=window.setTimeout(checkAllowanceContinued,15e3)})}async function swapTokens(){$("#swap_action_button").css("opacity","0.7"),$("#swap_action_button").prop("disabled",!0),$("#swap_action_button").html("MAKING SWAP...");var e="https://apiv4.paraswap.io/v2/transactions/1?useReduxToken=false&onlyParams=false&skipChecks=true",t={receiver:userAddress,srcToken:sendTokenAddress.toLowerCase(),fromDecimals:parseInt(swapData.sendDecimals.toString(10)),destToken:receiveTokenAddress.toLowerCase(),toDecimals:parseInt(swapData.receiveDecimals.toString(10)),referrer:"stabilize",userAddress:routerAddress,priceRoute:swapData.priceRoute,srcAmount:swapData.sendAmount.dp(0).toString(10),destAmount:swapData.minReceiveAmount.dp(0).toString(10)},a=null;if(await $.ajax({url:e,headers:{"X-Partner":"stabilize"},method:"POST",contentType:"application/json",data:JSON.stringify(t)}).then(e=>{a=e}).fail((e,t,a)=>{console.log("Failed to create swap transaction data")}),null==a)return void $("#swap_action_button").html("INTERNAL ERROR (1)");if(!a.data)return void $("#swap_action_button").html("INTERNAL ERROR (1)");var n=new BigNumber(0);sendTokenAddress==ethAddress.toUpperCase()&&(n=swapData.sendAmount.dp(0));var o=padleftzero(sendTokenAddress.toLowerCase().substring(2),64),s=padleftzero(receiveTokenAddress.toLowerCase().substring(2),64),r=padleftzero(swapData.sendAmount.dp(0).toString(16),64),i=formatToPositionHex(4,""),d=formatToEthereumBytes(a.data),c=new BigNumber(2e6),l=[{to:routerAddress.toLowerCase(),from:userAddress,gas:"0x"+c.toString(16),value:"0x"+n.toString(16),data:"0x"+contract_query_fee+o+s+r+i+d},"latest"],u=new BigNumber(0),m=new BigNumber(0);if(await ethereum.request({method:"eth_call",params:l}).then(e=>{var t=e.substring(2);u=new BigNumber("0x"+t.substring(0,64)),m=new BigNumber("0x"+t.substring(64,128))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0==u.comparedTo(0))return console.log("Failed to get fee data"),void $("#swap_action_button").html("TOO MUCH SLIPPAGE");u=u.times(.999).dp(0);var p=null;if(receiveTokenAddress!=ethAddress.toUpperCase()&&receiveTokenAddress!=wethAddress.toUpperCase()){var h="https://apiv4.paraswap.io/v2/prices";h+="?from="+receiveTokenAddress.toLowerCase()+"&fromDecimals="+swapData.receiveDecimals.toString(10)+"&to="+wethAddress.toLowerCase()+"&toDecimals=18&amount="+u.toString(10)+"&side=SELL&network=1";var w=null;if(await $.ajax({url:h,method:"GET"}).then(e=>{w=e.priceRoute}).fail((e,t,a)=>{console.log("Failed to find trade route")}),null==w)return console.log("Failed to find fee route"),void $("#swap_action_button").html("INTERNAL ERROR (3)");if(t={receiver:routerAddress,srcToken:receiveTokenAddress.toLowerCase(),fromDecimals:parseInt(swapData.receiveDecimals.toString(10)),destToken:wethAddress.toLowerCase(),toDecimals:18,referrer:"none",userAddress:routerAddress,priceRoute:w,srcAmount:u.dp(0).toString(10),destAmount:new BigNumber(1).toString(10)},await $.ajax({url:e,method:"POST",contentType:"application/json",data:JSON.stringify(t)}).then(e=>{p=e.data}).fail((e,t,a)=>{console.log("Failed to create fee transaction data")}),null==p)return void $("#swap_action_button").html("INTERNAL ERROR (4)")}else p="0x";var k=m.plus(deadlineTime.times(60)),g=padleftzero(u.dp(0).toString(16),64),b=padleftzero(k.toString(16),64);i=formatToPositionHex(7,"");var T=formatToPositionHex(7,d),_=formatToEthereumBytes(p),f=contract_swap_tokens+o+s+r+g+b+i+T+d+_;l=[{to:routerAddress.toLowerCase(),from:userAddress,gas:"0x"+c.toString(16),value:"0x"+n.toString(16),data:"0x"+f},"latest"];var A=new BigNumber(0);if(await ethereum.request({method:"eth_estimateGas",params:l}).then(e=>{var t=e.substring(2);A=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0==A.comparedTo(0))return void $("#swap_action_button").html("INTERNAL ERROR (5)");const v=[{to:routerAddress.toLowerCase(),value:"0x"+n.toString(16),from:userAddress,data:"0x"+f}];$("#swap_action_button").html("SWAP TOKENS"),$("#swap_action_button").css("opacity","1"),$("#swap_action_button").prop("disabled",!1),sendETHTransaction(v,function(){$("#swap_action_button").css("opacity","0.7"),$("#swap_action_button").prop("disabled",!0),$("#swap_action_button").html("SELECT SWAP AMOUNT"),$("#send_amount").val(""),$("#receive_amount").val("")})}function formatToEthereumBytes(e){e=e.substring(2);var t=new BigNumber(e.length).div(2);(t=padleftzero(t.toString(16),64),e.length<64)?e=padrightzero(e,64):e=padrightzero(e,64*parseInt(new BigNumber(e.length).div(64).integerValue(BigNumber.ROUND_CEIL).toString(10)));return t+e}function formatToPositionHex(e,t){return padleftzero(new BigNumber(64*e+t.length).div(2).toString(16),64)}async function sendETHTransaction(e,t){var a=await ethereum.request({method:"eth_chainId"});0==(a=new BigNumber("0x"+a.substring(2))).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,a){var n="";if(a>0){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3),n="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var o=a[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});