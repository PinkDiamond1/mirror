var poolTimer,detectMetamask=!1,metamaskConnected=!1,userAddress="",stbzPrice=0,ethPrice=new BigNumber(0),btcPrice=new BigNumber(0),circulatingSupply=new BigNumber(0),TVL=new BigNumber(0),totalTreasury=new BigNumber(0),operatorAddress="0xEe9156C93ebB836513968F92B4A67721f3cEa08a",wethAddress="0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",stbzAddress="0xB987D48Ed8f2C468D52D6405624EADBa5e76d723",oracleAddress="0x81A363F3C747dbE947b43486Db4C6AA4DC70DDc4",stakingAddress="0x8c17bE13e034f7fa2a6496bC83B6010be6305204",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_getreserves="0902f1ac",contract_token0address="0dfe1681",contract_tokenprice="7b1b1de6",contract_strategyprice="2e16d54e",contract_deposit="e2bbb158",contract_staking_deposit="a694fc3a",contract_exit="2af9cc41",contract_staking_exit="7f8661a1",contract_claimReward="1c4b774b",contract_staking_claimReward="3d18b912",contract_poolBalance="351e7cb3",contract_staking_poolBalance="68abb5e0",contract_poolSize="dd034779",contract_staking_poolSize="4ec18db9",contract_rewardEarned="cdfa2c36",contract_staking_rewardEarned="008cc262",contract_rewardRate="cea01962",contract_staking_rewardRate="7b0a47ee",contract_circsupply="9358928b",contract_claimTreasury="379607f5",contract_treasuryBalance="9105d748",contract_mint_week="19597a56",contract_last_oracle="0c89a0f0",contract_period_end="0962c4f9",contract_rebalance_pools="882229f3",contract_getPrice="41976e09",targetNetwork=1,poolList=[],pricesList=[],treasuryList=[],poolRotation=0;function loadPoolList(){poolList.push({poolID:0,poolToken:"0xdb28312a8d26d59978d9b86ca185707b1a26725b",units:"LP",decimals:18,panel:"0",proxy:!1,stbzPool:!1}),poolList.push({poolID:14,poolToken:"0x8e769EAA31375D13a1247dE1e64987c28Bed987E",units:"zs-USD",decimals:18,panel:"15",proxy:!0,underlyingUnits:"USD",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:11393244,usdPrice:1}),poolList.push({poolID:23,poolToken:"0x06C3467b2FcFc7431E92ecCE9dcb14D18bd518a2",units:"zs-tsBTC",decimals:18,panel:"24",proxy:!0,underlyingUnits:"BTC",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:12242240,usdPrice:1}),poolList.push({poolID:20,poolToken:"0x93B97BBb3F65EC39ea6041bF92FA998e5434E858",units:"zs-ETH",decimals:18,panel:"21",proxy:!0,underlyingUnits:"ETH",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:11999453,usdPrice:1}),poolList.push({poolID:19,poolToken:"0x27E8d93D27f55130B1870d8EF2BCE847C08A8191",units:"zs-UST",decimals:18,panel:"20",proxy:!0,underlyingUnits:"UST",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:11939455,usdPrice:1}),poolList.push({poolID:22,poolToken:"0xB5eB7528aCB55480b4221E498834FBc8cCBCd834",units:"zs-XUSD2",decimals:18,panel:"23",proxy:!0,underlyingUnits:"XUSD2",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:12121992,usdPrice:1}),poolList.push({poolID:24,poolToken:"0x78172170DbD084D5EA8c24c60885C755Fc8EFA62",units:"zs-AMPL",decimals:18,panel:"25",proxy:!0,underlyingUnits:"AMPL",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:12326653,usdPrice:1}),poolList.push({poolID:25,poolToken:"0x544b3FF2174016949e56C370808B2C05197b4aff",units:"zs-FEI",decimals:18,panel:"26",proxy:!0,underlyingUnits:"FEI",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:12414661,usdPrice:1}),poolList.push({poolID:-1,poolToken:stbzAddress,units:"STBZ",decimals:18,panel:"9",proxy:!1,stbzPool:!0}),matchPoolToPrices()}function loadInactivePoolList(){poolList.push({poolID:15,poolToken:"0x739D93f2b116E6aD754e173655c635Bd5D8d664c",units:"zs-BTC",decimals:18,panel:"16",proxy:!0,underlyingUnits:"BTC",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:11441662,usdPrice:1}),poolList.push({poolID:18,poolToken:"0xD469BB16116443F389EfEF407D73EF7Ab0Ad96Ce",units:"zs-FRAX",decimals:18,panel:"19",proxy:!0,underlyingUnits:"FRAX",stbzPool:!1,underlyingInterestMethod:"strategy",underlyingInterestData:11757442,usdPrice:1}),poolList.push({poolID:16,poolToken:"0xfea2468C55E80aB9487f6E6189C79Ce31E1f9Ea7",units:"zs-SGR",decimals:18,panel:"17",proxy:!0,underlyingUnits:"SGR",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:11564062,usdPrice:1}),poolList.push({poolID:10,poolToken:"0x4dEaD8338cF5cb31122859b2Aec2b60416D491f0",units:"zpa-USDC",decimals:6,panel:"11",proxy:!0,underlyingUnits:"USDC",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",usdPrice:1}),poolList.push({poolID:13,poolToken:"0xfa8c04d342FBe24d871ea77807b1b93eC42A57ea",units:"zpa-DAI",decimals:18,panel:"14",proxy:!0,underlyingUnits:"DAI",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:"0x6B175474E89094C44Da98b954EedeAC495271d0F",usdPrice:1}),poolList.push({poolID:11,poolToken:"0x6B2e59b8EbE61B5ee0EF30021b7740C63F597654",units:"zpa-USDT",decimals:6,panel:"12",proxy:!0,underlyingUnits:"USDT",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:"0xdAC17F958D2ee523a2206206994597C13D831ec7",usdPrice:1}),poolList.push({poolID:1,poolToken:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"DAI",decimals:18,panel:"1",proxy:!1,stbzPool:!1}),poolList.push({poolID:6,poolToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",units:"za-USDT",decimals:6,panel:"6",proxy:!0,underlyingUnits:"USDT",stbzPool:!1,underlyingInterestMethod:"none",underlyingInterestData:"0xdAC17F958D2ee523a2206206994597C13D831ec7",usdPrice:1}),matchPoolToPrices()}function checkMetaMaskExist(){void 0!==window.ethereum&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect Wallet"):0==metamaskConnected&&enableMetaMask())}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){var t=await ethereum.request({method:"eth_chainId"});if(0!=(t=new BigNumber("0x"+t.substring(2))).comparedTo(targetNetwork))return void(0==t.comparedTo(56)?$("#data_panel").length&&window.location.replace("../"):alert("This application requires the ETH network, please switch it in your MetaMask UI."));userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#data_panel").length&&($("#loading_panel").hide(),$("#data_panel").show(),getPrices()),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function showInactivePools(){$("#inactive_pool_controller").html("INACTIVE POOLS"),$("#inactive_pool_container").show(),0==poolRotation&&TVL.comparedTo(0)>0?(poolRotation=poolList.length,loadInactivePoolList(),clearTimeout(poolTimer),poolTimer=window.setTimeout(function(){refreshPoolData(!0)},6e4),refreshPoolData(!1)):loadInactivePoolList()}function checkOperatorState(){var e=0,t=Math.floor((new Date).getTime()/1e3);const o=[{to:operatorAddress,data:"0x"+contract_period_end},"latest"];ethereum.request({method:"eth_call",params:o}).then(o=>{var n=o.substring(2);new BigNumber("0x"+n.substring(0,64)).comparedTo(t)<=0&&(e=1),0!=e?1==e&&($("#pool_action").html("START NEW REWARD WEEK >"),"none"==$("#pool_action").css("display")&&$("#pool_action").fadeIn(1e3)):"none"!=$("#pool_action").css("display")&&$("#pool_action").fadeOut(1e3)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function performOperatorAction(){var e=$("#pool_action").html().toLowerCase();0!=e.length&&sendETHTransaction(e.indexOf("rebalance")>-1?[{to:operatorAddress,from:userAddress,data:"0x"+contract_rebalance_pools}]:[{to:operatorAddress,from:userAddress,data:"0x"+contract_mint_week}],function(){$("#pool_action").fadeOut(1e3)})}function getPrices(){var e=!1;0==poolList.length&&(e=!0,loadPoolList());$.get("https://api.coingecko.com/api/v3/simple/price?ids=ethereum,bitcoin,empty-set-dollar,dynamic-set-dollar&vs_currencies=usd",function(t){if(t){ethPrice=new BigNumber(t.ethereum.usd),btcPrice=new BigNumber(t.bitcoin.usd);var o=new BigNumber(t["empty-set-dollar"].usd),n=new BigNumber(t["dynamic-set-dollar"].usd),r=o.plus(n).div(2);(pricesList={}).ETH=new BigNumber(ethPrice),pricesList.BTC=new BigNumber(btcPrice),pricesList.SGR=new BigNumber(r),matchPoolToPrices(),1==e&&refreshPoolData(!0)}})}function matchPoolToPrices(){if(0!=poolList.length)for(var e=0;e<poolList.length;e++)"zs-tsBTC"==poolList[e].units?poolList[e].usdPrice=pricesList.BTC:"zs-ETH"==poolList[e].units?poolList[e].usdPrice=pricesList.ETH:"zs-SGR"==poolList[e].units?poolList[e].usdPrice=pricesList.SGR:"zs-BTC"==poolList[e].units&&(poolList[e].usdPrice=pricesList.BTC)}async function calculateUnderlyingInterest(e){var t=poolList[e].underlyingInterestMethod,o=poolList[e].underlyingInterestData,n=poolList[e].panel;if("aave"==t){const e=[{to:"0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3",data:"0xc540148e"+padleftzero(o.substring(2),64)},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var t=e.substring(2),o=new BigNumber("0x"+t.substring(0,64));o=o.div(new BigNumber(10).pow(25)),$("#panel_"+n+"_interest_link").html(o.dp(2).toString(10)+"% &#9654;")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}else if("strategy"==t){var r,a,s,i=new BigNumber(o),l=poolList[e].poolToken;if(await ethereum.request({method:"eth_blockNumber",params:[]}).then(e=>{var t=e.substring(2);r=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),r.minus(6527).comparedTo(i)<0)return;a=[{to:l,data:"0x"+contract_tokenprice},"0x"+r.toString(16)],await ethereum.request({method:"eth_call",params:a}).then(e=>{var t=e.substring(2);s=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),a=[{to:l,data:"0x"+contract_tokenprice},"0x"+r.minus(45689).toString(16)],await ethereum.request({method:"eth_call",params:a}).then(e=>{var t=e.substring(2),o=new BigNumber("0x"+t.substring(0,64)),r=s.div(o).minus(1).div(7).times(100).times(365);r.comparedTo(.001)>0?$("#panel_"+n+"_interest_link").html(r.dp(2).toString(10)+"% &#9654;"):$("#panel_"+n+"_interest_link").html("N/A &#9654;")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}else"none"==t&&$("#panel_"+n+"_interest_link").html("0% &#9654;")}async function refreshPoolData(e){if(0==poolRotation)TVL=new BigNumber(0),null!=poolTimer&&clearTimeout(poolTimer),poolTimer=window.setTimeout(function(){refreshPoolData(!0)},6e4);else if(1==e)return null!=poolTimer&&clearTimeout(poolTimer),void(poolTimer=window.setTimeout(function(){refreshPoolData(!0)},6e4));var t=poolList[poolRotation].panel;if("none"==$("#panel_"+t+"_action_buttons").css("display")&&"none"==$("#panel_"+t+"_unlock_button").css("display")||1==$("#panel_"+t+"_unlock_inner_button").prop("disabled")){var o=poolList[poolRotation].poolToken,n=padleftzero(userAddress.substring(2),64),r=padleftzero(operatorAddress.substring(2),64);1==poolList[poolRotation].stbzPool&&(r=padleftzero(stakingAddress.substring(2),64));const e=[{to:o,data:"0x"+contract_viewallowance+n+r},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var o=e.substring(2);new BigNumber("0x"+o.substring(0,64)).comparedTo(1)<0?$("#panel_"+t+"_unlock_button").show():($("#panel_"+t+"_unlock_button").hide(),$("#panel_"+t+"_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}var a,s,i,l=poolRotation;if(0==poolList[l].stbzPool){var c=new BigNumber(poolList[l].poolID).toString(16);c=padleftzero(c,64),a=[{to:operatorAddress,data:"0x"+contract_poolSize+c},"latest"]}else a=[{to:stakingAddress,data:"0x"+contract_staking_poolSize},"latest"];await ethereum.request({method:"eth_call",params:a}).then(e=>{var o=e.substring(2);s=(s=new BigNumber("0x"+o.substring(0,64))).div(new BigNumber(10).pow(poolList[l].decimals)),i=2,s.comparedTo(.01)<0&&(i=8),$("#panel_"+t+"_poolsize").html(s.dp(i).toString(10)+" "+poolList[l].units)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var d;n=padleftzero(userAddress.substring(2),64);a=0==poolList[l].stbzPool?[{to:operatorAddress,data:"0x"+contract_poolBalance+c+n},"latest"]:[{to:stakingAddress,data:"0x"+contract_staking_poolBalance+n},"latest"],await ethereum.request({method:"eth_call",params:a}).then(e=>{var o=e.substring(2);d=(d=new BigNumber("0x"+o.substring(0,64))).div(new BigNumber(10).pow(poolList[l].decimals)),$("#panel_"+t+"_mybalance").html(d.dp(i).toString(10)+" "+poolList[l].units),d.comparedTo(0)<=0?"none"!=$("#panel_"+t+"_withdraw_button").css("display")&&($("#panel_"+t+"_withdraw_button").hide(),$("#panel_"+t+"_claim_button").hide()):"none"==$("#panel_"+t+"_withdraw_button").css("display")&&($("#panel_"+t+"_withdraw_button").show(),$("#panel_"+t+"_claim_button").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))});var p=new BigNumber(1);1==poolList[l].proxy&&(a=[{to:poolList[l].poolToken,data:"0x"+contract_tokenprice},"latest"],await ethereum.request({method:"eth_call",params:a}).then(e=>{var o=e.substring(2);p=(p=new BigNumber("0x"+o.substring(0,64))).div(new BigNumber(10).pow(18));var n=d.times(p);$("#panel_"+t+"_value").html(n.dp(i).toString(10)+" "+poolList[l].underlyingUnits);var r=s.times(p).times(poolList[l].usdPrice);console.log("Pool "+l+" usd value: "+r.dp(2).toString(10)),TVL=TVL.plus(r),poolList.length}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})),a=0==poolList[l].stbzPool?[{to:operatorAddress,data:"0x"+contract_rewardEarned+c+n},"latest"]:[{to:stakingAddress,data:"0x"+contract_staking_rewardEarned+n},"latest"],await ethereum.request({method:"eth_call",params:a}).then(e=>{var o=e.substring(2),n=new BigNumber("0x"+o.substring(0,64));n=n.div(new BigNumber(10).pow(18)),0==poolList[l].stbzPool?($("#panel_"+t+"_rewardbalance").html(n.dp(4).toString(10)+" STBZ"),a=[{to:operatorAddress,data:"0x"+contract_rewardRate+c},"latest"]):($("#panel_"+t+"_rewardbalance").html(n.dp(8).toString(10)+" WETH"),a=[{to:stakingAddress,data:"0x"+contract_staking_rewardRate},"latest"])}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),await ethereum.request({method:"eth_call",params:a}).then(e=>{var o=e.substring(2),n=new BigNumber("0x"+o.substring(0,64));if("LP"!=poolList[l].units){n=n.div(new BigNumber(10).pow(18)),n=0==poolList[l].stbzPool?n.times(stbzPrice):n.times(ethPrice),s.comparedTo(0)>0&&(1==poolList[l].proxy&&0==(s=s.times(poolList[l].usdPrice).times(p)).comparedTo(0)&&(s=new BigNumber(1)),0==poolList[l].proxy&&0==poolList[l].stbzPool&&(console.log("Pool Normal "+l+" usd value: "+s.dp(2).toString(10)),TVL=TVL.plus(s)),0==poolList[l].stbzPool?n=n.div(s):(n=n.div(s.times(stbzPrice)),n=new BigNumber(0)));var r=n.times(new BigNumber(86400)),a=2;(r=r.times(100)).comparedTo("0.01")<0&&(a=8),$("#panel_"+t+"_dpy").html(r.dp(a).toString(10)+"%");var i=r.times(365);a=2,i.comparedTo("0.01")<0&&(a=8),$("#panel_"+t+"_apr").html(i.dp(a).toString(10)+"%");var c=i.div(100);a=2,(c=c.div(52).plus(1).pow(52).minus(1).times(100)).comparedTo("0.01")<0&&(a=8);var d=c.dp(a).toString(10)+"%";if(c.comparedTo("1000000")>0&&(d="> 1000000%"),1==poolList[l].proxy){var u="---";$("#panel_"+t+"_interest_link").length>0&&(u=$("#panel_"+t+"_interest_link").html()),$("#panel_"+t+"_apy").html(d+" + <a id='panel_"+t+"_interest_link' href='wrap/' style='color: rgb(40,200,40);'>"+u+"</a>"),calculateUnderlyingInterest(l)}else $("#panel_"+t+"_apy").html(d);poolList.length,++poolRotation>=poolList.length?(getPrices(),poolRotation=0):window.setTimeout(function(){refreshPoolData(!1)},500)}else getLPTokenDPY(l,s,n)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function getLPTokenDPY(e,t,o){const n=[{to:poolList[e].poolToken,data:"0x"+contract_getreserves},"latest"];ethereum.request({method:"eth_call",params:n}).then(n=>{var r=n.substring(2),a=new BigNumber("0x"+r.substring(0,64)),s=new BigNumber("0x"+r.substring(64,128));const i=[{to:poolList[e].poolToken,data:"0x"+contract_token0address},"latest"];ethereum.request({method:"eth_call",params:i}).then(n=>{var r=n.substring(2).substring(0,64).toLowerCase(),i=padleftzero(wethAddress.substring(2),64).toLowerCase();const l=[{to:poolList[e].poolToken,data:"0x"+contract_totalsupply},"latest"];ethereum.request({method:"eth_call",params:l}).then(n=>{var l=n.substring(2),c=new BigNumber("0x"+l.substring(0,64));if(!(c.comparedTo(0)<=0||ethPrice.comparedTo(0)<=0)){var d=0;r==i?(a=a.div(new BigNumber(10).pow(18)).times(ethPrice),0==e&&(stbzPrice=a.div(s.div(new BigNumber(10).pow(18)))),s=new BigNumber(a)):(s=s.div(new BigNumber(10).pow(18)).times(ethPrice),0==e&&(stbzPrice=s.div(a.div(new BigNumber(10).pow(18)))),a=new BigNumber(s)),d=a.plus(s),c=c.div(new BigNumber(10).pow(18));var p=t.div(c),u=d.times(p);u.comparedTo(0)<=0?u=1:(console.log("LP Pool usd value: "+u.dp(2).toString(10)),TVL=TVL.plus(u));var g=(o=(o=(o=o.div(new BigNumber(10).pow(18))).times(stbzPrice)).div(u)).times(new BigNumber(86400));g=g.times(100),$("#panel_"+poolList[e].panel+"_dpy").html(g.dp(2).toString(10)+"%");var m=g.times(365);$("#panel_"+poolList[e].panel+"_apr").html(m.dp(2).toString(10)+"%");var h=m.div(100);h=h.div(52).plus(1).pow(52).minus(1).times(100),$("#panel_"+poolList[e].panel+"_apy").html(h.dp(2).toString(10)+"%"),poolList.length,++poolRotation>=poolList.length?(getPrices(),poolRotation=0):window.setTimeout(function(){refreshPoolData(!1)},500)}}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function unlockToken(e){for(var t=0,o=0;o<poolList.length;o++)if(parseInt(poolList[o].panel)==e){t=o;break}var n=new BigNumber(2).pow(256).minus(1),r=operatorAddress.substring(2);1==poolList[t].stbzPool&&(r=stakingAddress.substring(2)),r=padleftzero(r.toLowerCase(),64);var a=n.toString(16);a=padleftzero(a,64),sendETHTransaction([{to:poolList[t].poolToken,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+r+a}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING "+poolList[t].units)})}function selectMaxOut(e){for(var t,o=0,n=0;n<poolList.length;n++)if(parseInt(poolList[n].panel)==e){o=n;break}if(0==poolList[o].stbzPool){var r=new BigNumber(poolList[o].poolID).toString(16);r=padleftzero(r,64);var a=padleftzero(userAddress.substring(2),64);t=[{to:operatorAddress,data:"0x"+contract_poolBalance+r+a},"latest"]}else{a=padleftzero(userAddress.substring(2),64);t=[{to:stakingAddress,data:"0x"+contract_staking_poolBalance+a},"latest"]}ethereum.request({method:"eth_call",params:t}).then(t=>{var n=t.substring(2),r=new BigNumber("0x"+n.substring(0,64));r=r.div(new BigNumber(10).pow(poolList[o].decimals)),$("#panel_"+e+"_amount").val(r.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxIn(e){for(var t=0,o=0;o<poolList.length;o++)if(parseInt(poolList[o].panel)==e){t=o;break}var n=padleftzero(userAddress.substring(2),64);const r=[{to:poolList[t].poolToken,data:"0x"+contract_balanceof+n},"latest"];ethereum.request({method:"eth_call",params:r}).then(o=>{var n=o.substring(2),r=new BigNumber("0x"+n.substring(0,64));r=r.div(new BigNumber(10).pow(poolList[t].decimals)),$("#panel_"+e+"_amount").val(r.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function deposit(e){for(var t=0,o=0;o<poolList.length;o++)if(parseInt(poolList[o].panel)==e){t=o;break}var n=new BigNumber($("#panel_"+e+"_amount").val());if(!(n.isNaN()||n.comparedTo(0)<=0)){var r,a=(n=n.times(new BigNumber(10).pow(poolList[t].decimals))).toString(16);if(a=padleftzero(a,64),0==poolList[t].stbzPool){var s=new BigNumber(poolList[t].poolID).toString(16);s=padleftzero(s,64),r=[{to:operatorAddress,gas:"0x493E0",from:userAddress,data:"0x"+contract_deposit+s+a}]}else r=[{to:stakingAddress,gas:"0x493E0",from:userAddress,data:"0x"+contract_staking_deposit+a}];sendETHTransaction(r,null)}}function withdraw(e){for(var t=0,o=0;o<poolList.length;o++)if(parseInt(poolList[o].panel)==e){t=o;break}var n=new BigNumber($("#panel_"+e+"_amount").val());if(!(n.isNaN()||n.comparedTo(0)<=0)){var r,a=(n=n.times(new BigNumber(10).pow(poolList[t].decimals))).toString(16);if(a=padleftzero(a,64),0==poolList[t].stbzPool){var s=new BigNumber(poolList[t].poolID).toString(16);s=padleftzero(s,64),r=[{to:operatorAddress,gas:"0x493E0",from:userAddress,data:"0x"+contract_exit+s+a}]}else r=[{to:stakingAddress,gas:"0x493E0",from:userAddress,data:"0x"+contract_staking_exit+a}];sendETHTransaction(r,null)}}function claimReward(e){for(var t=0,o=0;o<poolList.length;o++)if(parseInt(poolList[o].panel)==e){t=o;break}var n=new BigNumber(poolList[t].poolID).toString(16);n=padleftzero(n,64),sendETHTransaction(0==poolList[t].stbzPool?[{to:operatorAddress,gas:"0x30D40",from:userAddress,data:"0x"+contract_claimReward+n}]:[{to:stakingAddress,gas:"0x30D40",from:userAddress,data:"0x"+contract_staking_claimReward}],null)}async function sendETHTransaction(e,t){var o=await ethereum.request({method:"eth_chainId"});0==(o=new BigNumber("0x"+o.substring(2))).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,o){var n="";if(o>0){var r=new Date;r.setTime(r.getTime()+24*o*60*60*1e3),n="; expires="+r.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var r=o[n];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});