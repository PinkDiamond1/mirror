var detectMetamask=!1,metamaskConnected=!1,userAddress="",aave_lending_pool_core="0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3",contract_getrate="c540148e",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",targetNetwork=1,tokenList=[],tokenRotation=0;function loadTokenList(){tokenList.push({zaToken:"0x1D107B258a2BA3a87B301e635dDc336cfDDe153b",underlying:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",units:"za-USDC",underlyingUnits:"USDC",decimals:6,panel:"0"}),tokenList.push({zaToken:"0x38ea93D59cc7B83DA7847E9a22eACDDc0751Af77",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"za-DAI",underlyingUnits:"DAI",decimals:18,panel:"1"}),tokenList.push({zaToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"za-USDT",underlyingUnits:"USDT",decimals:6,panel:"2"}),tokenList.push({zaToken:"0x2f81fcd5222e0F183Dc2F70d55f4c84fcB59BF4C",underlying:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",units:"za-sUSD",underlyingUnits:"sUSD",decimals:18,panel:"3"})}function checkMetaMaskExist(){void 0!==window.ethereum&&(1==ethereum.isMetaMask&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect MetaMask"):0==metamaskConnected&&enableMetaMask()))}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){if(ethereum.chainId||(ethereum.chainId="0x1"),0!=new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork))return void alert("This application requires the main network, please switch it in your MetaMask UI.");userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function getAaveInterestRate(e){var t=tokenList[e].panel,n=padleftzero(tokenList[e].underlying.substring(2),64);const a=[{to:aave_lending_pool_core,data:"0x"+contract_getrate+n},"latest"];ethereum.request({method:"eth_call",params:a}).then(e=>{var n=e.substring(2),a=new BigNumber("0x"+n.substring(0,64));a=a.div(new BigNumber(10).pow(25)),$("#panel_"+t+"_apr").html(a.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function refreshTokenData(e){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(1==e)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var t=tokenList[tokenRotation].panel,n=tokenList[tokenRotation].underlying,a=tokenList[tokenRotation].zaToken,o=padleftzero(userAddress.substring(2),64),r=padleftzero(tokenList[tokenRotation].zaToken.substring(2),64);if("none"==$("#panel_"+t+"_action_buttons").css("display")&&"none"==$("#panel_"+t+"_unlock_button").css("display")||1==$("#panel_"+t+"_unlock_inner_button").prop("disabled")){const e=[{to:n,data:"0x"+contract_viewallowance+o+r},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var n=e.substring(2);new BigNumber("0x"+n.substring(0,64)).comparedTo(1)<0?$("#panel_"+t+"_unlock_button").show():($("#panel_"+t+"_unlock_button").hide(),$("#panel_"+t+"_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}getAaveInterestRate(tokenRotation);var i=tokenRotation;const s=[{to:a,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:s}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(10).pow(tokenList[i].decimals)),$("#panel_"+t+"_walletbalance").html(o.dp(3).toString(10)+" "+tokenList[i].units);const r=[{to:a,data:"0x"+contract_tokenprice},"latest"];ethereum.request({method:"eth_call",params:r}).then(e=>{var n=e.substring(2),a=new BigNumber("0x"+n.substring(0,64));a=a.div(new BigNumber(10).pow(18)),$("#panel_"+t+"_price").html(a.toFormat(6)+" "+tokenList[i].underlyingUnits);var r=a.times(o);$("#panel_"+t+"_value").html(r.dp(3).toString(10)+" "+tokenList[i].underlyingUnits),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function unlockWrapper(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var a=new BigNumber(2).pow(256).minus(1),o=tokenList[t].zaToken.substring(2);o=padleftzero(o,64);var r=a.toString(16);r=padleftzero(r,64),sendETHTransaction([{to:tokenList[t].underlying,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+o+r}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var a=padleftzero(userAddress.substring(2),64);const o=[{to:tokenList[t].underlying,data:"0x"+contract_balanceof+a},"latest"];ethereum.request({method:"eth_call",params:o}).then(n=>{var a=n.substring(2),o=new BigNumber("0x"+a.substring(0,64));o=o.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(o)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxUnwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var a=padleftzero(userAddress.substring(2),64);const o=[{to:tokenList[t].zaToken,data:"0x"+contract_balanceof+a},"latest"];ethereum.request({method:"eth_call",params:o}).then(n=>{var a=n.substring(2),o=new BigNumber("0x"+a.substring(0,64));o=o.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(o)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function wrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var a=new BigNumber($("#panel_"+e+"_amount").val());if(a.comparedTo(0)<=0)return;var o=(a=a.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);o=padleftzero(o,64);var r="0x7A120";"sUSD"==tokenList[n].underlyingUnits&&(r="0x927C0"),sendETHTransaction([{to:tokenList[t].zaToken,gas:r,from:userAddress,data:"0x"+contract_deposit+o}],null)}function unwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var a=new BigNumber($("#panel_"+e+"_amount").val());if(a.comparedTo(0)<=0)return;var o=(a=a.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);o=padleftzero(o,64),sendETHTransaction([{to:tokenList[t].zaToken,gas:"0xDBBA0",from:userAddress,data:"0x"+contract_redeem+o}],null)}function sendETHTransaction(e,t){0==new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,n){var a="";if(n>0){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+a+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});