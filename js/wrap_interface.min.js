var detectMetamask=!1,metamaskConnected=!1,userAddress="",aave_lending_pool_core="0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3",contract_getrate="c540148e",contract_getratio="ec1ebd7a",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",targetNetwork=1,tokenList=[],tokenRotation=0;$(window).on("load",function(){checkMetaMaskExist()});function loadTokenList(){tokenList.push({zToken:"0x1D107B258a2BA3a87B301e635dDc336cfDDe153b",underlying:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",units:"za-USDC",underlyingUnits:"USDC",decimals:6,panel:"0",tokenType:0}),tokenList.push({zToken:"0x38ea93D59cc7B83DA7847E9a22eACDDc0751Af77",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"za-DAI",underlyingUnits:"DAI",decimals:18,panel:"1",tokenType:0}),tokenList.push({zToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"za-USDT",underlyingUnits:"USDT",decimals:6,panel:"2",tokenType:0}),tokenList.push({zToken:"0x2f81fcd5222e0F183Dc2F70d55f4c84fcB59BF4C",underlying:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",units:"za-sUSD",underlyingUnits:"sUSD",decimals:18,panel:"3",tokenType:0}),tokenList.push({zToken:"0x5721f00507DCF54174b8Ac450d60Da3e7aA1f2Dc",underlying:"0x0d4a11d5eeaac28ec3f61d100daf4d40471f1852",units:"zs-LP",underlyingUnits:"LP",decimals:18,panel:"4",tokenType:1}),tokenList.push({zToken:"0x2212F60BC949cF09a8BCCcA29038014094A70231",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"zs-DAI",underlyingUnits:"DAI",decimals:18,panel:"5",tokenType:1})}function checkMetaMaskExist(){if("undefined"!=typeof window.ethereum&&!0==ethereum.isMetaMask){detectMetamask=!0;var a=getCookie("metamask");null==a?$("#metamask_interactive").html("Connect MetaMask"):!1==metamaskConnected&&enableMetaMask()}}async function enableMetaMask(){const a=await ethereum.request({method:"eth_requestAccounts"});if(a){ethereum.chainId||(ethereum.chainId="0x1");var b=new BigNumber("0x"+ethereum.chainId.substring(2));if(0!=b.comparedTo(targetNetwork))return void alert("This application requires the main network, please switch it in your MetaMask UI.");userAddress=a[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(a){userAddress=a[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(){location.reload()})}}function metamaskButtonClick(){if(!1==detectMetamask)window.open("https://metamask.io/","_blank");else!0==detectMetamask&&!1==metamaskConnected&&enableMetaMask()}function padleftzero(a,b){return a=a.toString(),a.length<b?padleftzero("0"+a,b):a}function padrightzero(a,b){return a=a.toString(),a.length<b?padrightzero(a+"0",b):a}function getAaveInterestRate(a){var b=tokenList[a].panel,c=padleftzero(tokenList[a].underlying.substring(2),64);ethereum.request({method:"eth_call",params:[{to:aave_lending_pool_core,data:"0x"+contract_getrate+c},"latest"]}).then(a=>{var c=a.substring(2),d=new BigNumber("0x"+c.substring(0,64));d=d.div(new BigNumber(10).pow(25)),$("#panel_"+b+"_apy").html(d.dp(4).toString(10)+"%")}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}function getPickleInterestRate(a){var b="",c=1;"0x5721f00507DCF54174b8Ac450d60Da3e7aA1f2Dc"==tokenList[a].zToken?(b="0x09FC573c502037B149ba87782ACC81cF093EC6ef",c=1.37):"0x2212F60BC949cF09a8BCCcA29038014094A70231"==tokenList[a].zToken&&(b="0x6949Bb624E8e8A90F87cD2058139fcd77D2F3F87",c=1.25);ethereum.request({method:"eth_blockNumber",params:[]}).then(d=>{var e=d.substring(2),f=new BigNumber("0x"+e.substring(0,64)),g=f.minus(6527);const h=[{to:b,data:"0x"+contract_getratio},"0x"+f.toString(16)];ethereum.request({method:"eth_call",params:h}).then(d=>{var e=d.substring(2),f=new BigNumber("0x"+e.substring(0,64));const h=[{to:b,data:"0x"+contract_getratio},"0x"+g.toString(16)];ethereum.request({method:"eth_call",params:h}).then(b=>{var d=b.substring(2),e=new BigNumber("0x"+d.substring(0,64)),g=f.div(e).minus(1),h=g.times(100).times(365);h=h.times(c),$("#panel_"+tokenList[a].panel+"_apy").html(h.dp(4).toString(10)+"%")}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}function refreshTokenData(a){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(!0==a)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var b=tokenList[tokenRotation].panel,c=tokenList[tokenRotation].underlying,d=tokenList[tokenRotation].zToken,e=padleftzero(userAddress.substring(2),64),f=padleftzero(tokenList[tokenRotation].zToken.substring(2),64);if("none"==$("#panel_"+b+"_action_buttons").css("display")&&"none"==$("#panel_"+b+"_unlock_button").css("display")||!0==$("#panel_"+b+"_unlock_inner_button").prop("disabled")){ethereum.request({method:"eth_call",params:[{to:c,data:"0x"+contract_viewallowance+e+f},"latest"]}).then(a=>{var c=a.substring(2),d=new BigNumber("0x"+c.substring(0,64));0>d.comparedTo(1)?$("#panel_"+b+"_unlock_button").show():($("#panel_"+b+"_unlock_button").hide(),$("#panel_"+b+"_action_buttons").show())}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}0==tokenList[tokenRotation].tokenType?getAaveInterestRate(tokenRotation):1==tokenList[tokenRotation].tokenType&&getPickleInterestRate(tokenRotation);var g=tokenRotation;ethereum.request({method:"eth_call",params:[{to:d,data:"0x"+contract_balanceof+e},"latest"]}).then(a=>{var c=a.substring(2),e=new BigNumber("0x"+c.substring(0,64));e=e.div(new BigNumber(10).pow(tokenList[g].decimals));var f=6;0>e.comparedTo("0.00001")&&(f=10),$("#panel_"+b+"_walletbalance").html(e.dp(f).toString(10)+" "+tokenList[g].units);ethereum.request({method:"eth_call",params:[{to:d,data:"0x"+contract_tokenprice},"latest"]}).then(a=>{var c=a.substring(2),d=new BigNumber("0x"+c.substring(0,64));d=d.div(new BigNumber(10).pow(18)),$("#panel_"+b+"_price").html(d.toFormat(6)+" "+tokenList[g].underlyingUnits);var h=d.times(e);$("#panel_"+b+"_value").html(h.dp(f).toString(10)+" "+tokenList[g].underlyingUnits),tokenRotation++,tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}function unlockWrapper(a){for(var b=0,c=0;c<tokenList.length;c++)if(parseInt(tokenList[c].panel)==a){b=c;break}var d=new BigNumber(2).pow(256).minus(1),e=tokenList[b].zToken.substring(2);e=padleftzero(e,64);var f=d.toString(16);f=padleftzero(f,64);const g=[{to:tokenList[b].underlying,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+e+f}];sendETHTransaction(g,function(){$("#panel_"+a+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+a+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(a){for(var b=0,c=0;c<tokenList.length;c++)if(parseInt(tokenList[c].panel)==a){b=c;break}var d=padleftzero(userAddress.substring(2),64);const e=[{to:tokenList[b].underlying,data:"0x"+contract_balanceof+d},"latest"];ethereum.request({method:"eth_call",params:e}).then(c=>{var d=c.substring(2),e=new BigNumber("0x"+d.substring(0,64));e=e.div(new BigNumber(10).pow(tokenList[b].decimals)),$("#panel_"+a+"_amount").val(e.toString(10))}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}function selectMaxUnwrap(a){for(var b=0,c=0;c<tokenList.length;c++)if(parseInt(tokenList[c].panel)==a){b=c;break}var d=padleftzero(userAddress.substring(2),64);const e=[{to:tokenList[b].zToken,data:"0x"+contract_balanceof+d},"latest"];ethereum.request({method:"eth_call",params:e}).then(c=>{var d=c.substring(2),e=new BigNumber("0x"+d.substring(0,64));e=e.div(new BigNumber(10).pow(tokenList[b].decimals)),$("#panel_"+a+"_amount").val(e.toString(10))}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))})}function wrap(a){for(var b=0,c=0;c<tokenList.length;c++)if(parseInt(tokenList[c].panel)==a){b=c;break}var d=new BigNumber($("#panel_"+a+"_amount").val());if(!d.isNaN()&&!(0>=d.comparedTo(0))){d=d.times(new BigNumber(10).pow(tokenList[b].decimals));var e=d.toString(16);e=padleftzero(e,64);const a=[{to:tokenList[b].zToken,from:userAddress,data:"0x"+contract_deposit+e}];sendETHTransaction(a,null)}}function unwrap(a){for(var b=0,c=0;c<tokenList.length;c++)if(parseInt(tokenList[c].panel)==a){b=c;break}var d=new BigNumber($("#panel_"+a+"_amount").val());if(!d.isNaN()&&!(0>=d.comparedTo(0))){d=d.times(new BigNumber(10).pow(tokenList[b].decimals));var e=d.toString(16);e=padleftzero(e,64);const a=[{to:tokenList[b].zToken,from:userAddress,data:"0x"+contract_redeem+e}];sendETHTransaction(a,null)}}function sendETHTransaction(a,b){var c=new BigNumber("0x"+ethereum.chainId.substring(2));return 0==c.comparedTo(targetNetwork)?void ethereum.request({method:"eth_sendTransaction",params:a}).then(a=>{console.log("Transaction hash: "+a),b&&b()}).catch(a=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(a))}):void alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(a,b,c){var d="";if(0<c){var e=new Date;e.setTime(e.getTime()+1e3*(60*(60*(24*c)))),d="; expires="+e.toUTCString()}document.cookie=a+"="+(b||"")+d+"; path=/; SameSite=Strict"}function getCookie(a){for(var b,d=a+"=",e=document.cookie.split(";"),f=0;f<e.length;f++){for(b=e[f];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(d))return b.substring(d.length,b.length)}return null}function eraseCookie(a){document.cookie=a+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}