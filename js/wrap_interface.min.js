var detectMetamask=!1,metamaskConnected=!1,userAddress="",aave_lending_pool_core="0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3",contract_getrate="c540148e",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",targetNetwork=1,tokenList=[],tokenRotation=0;function loadTokenList(){tokenList.push({zaToken:"0x1D107B258a2BA3a87B301e635dDc336cfDDe153b",underlying:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",units:"za-USDC",underlyingUnits:"USDC",decimals:6,panel:"0"}),tokenList.push({zaToken:"0x38ea93D59cc7B83DA7847E9a22eACDDc0751Af77",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"za-DAI",underlyingUnits:"DAI",decimals:18,panel:"1"}),tokenList.push({zaToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"za-USDT",underlyingUnits:"USDT",decimals:6,panel:"2"}),tokenList.push({zaToken:"0x2f81fcd5222e0F183Dc2F70d55f4c84fcB59BF4C",underlying:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",units:"za-sUSD",underlyingUnits:"sUSD",decimals:18,panel:"3"})}function checkMetaMaskExist(){void 0!==window.ethereum&&(1==ethereum.isMetaMask&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect MetaMask"):0==metamaskConnected&&enableMetaMask()))}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){if(ethereum.chainId||(ethereum.chainId="0x1"),0!=new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork))return void alert("This application requires the main network, please switch it in your MetaMask UI.");userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function getAaveInterestRate(e){var t=tokenList[e].panel,n=padleftzero(tokenList[e].underlying.substring(2),64);const o=[{to:aave_lending_pool_core,data:"0x"+contract_getrate+n},"latest"];ethereum.sendAsync({method:"eth_call",params:o,id:"1",jsonrpc:"2.0"},function(e,n){if(e)console.log("An error occurred while pinging blockchain");else if(n.error)console.log("RPC error: "+n.error);else{var o=n.result.substring(2),r=new BigNumber("0x"+o.substring(0,64));r=r.div(new BigNumber(10).pow(25)),$("#panel_"+t+"_apr").html(r.dp(4).toString(10)+"%")}})}function refreshTokenData(e){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(1==e)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var t=tokenList[tokenRotation].panel,n=tokenList[tokenRotation].underlying,o=tokenList[tokenRotation].zaToken,r=padleftzero(userAddress.substring(2),64),a=padleftzero(tokenList[tokenRotation].zaToken.substring(2),64);if("none"==$("#panel_"+t+"_action_buttons").css("display")&&"none"==$("#panel_"+t+"_unlock_button").css("display")||1==$("#panel_"+t+"_unlock_inner_button").prop("disabled")){const e=[{to:n,data:"0x"+contract_viewallowance+r+a},"latest"];ethereum.sendAsync({method:"eth_call",params:e,id:"1",jsonrpc:"2.0"},function(e,n){if(e)console.log("An error occurred while pinging blockchain");else if(n.error)console.log("RPC error: "+n.error);else{var o=n.result.substring(2);new BigNumber("0x"+o.substring(0,64)).comparedTo(1)<0?$("#panel_"+t+"_unlock_button").show():($("#panel_"+t+"_unlock_button").hide(),$("#panel_"+t+"_action_buttons").show())}})}getAaveInterestRate(tokenRotation);var s=tokenRotation;const i=[{to:o,data:"0x"+contract_balanceof+r},"latest"];ethereum.sendAsync({method:"eth_call",params:i,id:"1",jsonrpc:"2.0"},function(e,n){if(e)console.log("An error occurred while pinging blockchain");else if(n.error)console.log("RPC error: "+n.error);else{var r=n.result.substring(2),a=new BigNumber("0x"+r.substring(0,64));a=a.div(new BigNumber(10).pow(tokenList[s].decimals)),$("#panel_"+t+"_walletbalance").html(a.dp(3).toString(10)+" "+tokenList[s].units);const e=[{to:o,data:"0x"+contract_tokenprice},"latest"];ethereum.sendAsync({method:"eth_call",params:e,id:"1",jsonrpc:"2.0"},function(e,n){if(e)console.log("An error occurred while pinging blockchain");else if(n.error)console.log("RPC error: "+n.error);else{var o=n.result.substring(2),r=new BigNumber("0x"+o.substring(0,64));r=r.div(new BigNumber(10).pow(18)),$("#panel_"+t+"_price").html(r.toFormat(6)+" "+tokenList[s].underlyingUnits);var i=r.times(a);$("#panel_"+t+"_value").html(i.dp(3).toString(10)+" "+tokenList[s].underlyingUnits),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}})}})}function unlockWrapper(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber(2).pow(256).minus(1),r=tokenList[t].zaToken.substring(2);r=padleftzero(r,64);var a=o.toString(16);a=padleftzero(a,64),sendETHTransaction([{to:tokenList[t].underlying,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+r+a}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64);const r=[{to:tokenList[t].underlying,data:"0x"+contract_balanceof+o},"latest"];ethereum.sendAsync({method:"eth_call",params:r,id:"1",jsonrpc:"2.0"},function(n,o){if(n)console.log("An error occurred while pinging blockchain");else if(o.error)console.log("RPC error: "+o.error);else{var r=o.result.substring(2),a=new BigNumber("0x"+r.substring(0,64));a=a.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(a)}})}function selectMaxUnwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64);const r=[{to:tokenList[t].zaToken,data:"0x"+contract_balanceof+o},"latest"];ethereum.sendAsync({method:"eth_call",params:r,id:"1",jsonrpc:"2.0"},function(n,o){if(n)console.log("An error occurred while pinging blockchain");else if(o.error)console.log("RPC error: "+o.error);else{var r=o.result.substring(2),a=new BigNumber("0x"+r.substring(0,64));a=a.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(a)}})}function wrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.comparedTo(0)<=0)return;var r=(o=o.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);r=padleftzero(r,64);var a="0x7A120";"sUSD"==tokenList[n].underlyingUnits&&(a="0x927C0"),sendETHTransaction([{to:tokenList[t].zaToken,gas:a,from:userAddress,data:"0x"+contract_deposit+r}],null)}function unwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.comparedTo(0)<=0)return;var r=(o=o.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);r=padleftzero(r,64),sendETHTransaction([{to:tokenList[t].zaToken,gas:"0xDBBA0",from:userAddress,data:"0x"+contract_redeem+r}],null)}function sendETHTransaction(e,t){0==new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork)?ethereum.sendAsync({method:"eth_sendTransaction",params:e,from:userAddress},function(e,n){e?console.log("An error occurred while pinging blockchain"):n.error?console.log("RPC error: "+n.error):(console.log("Transaction hash: "+n.result),t&&t())}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,n){var o="";if(n>0){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),o="; expires="+r.toUTCString()}document.cookie=e+"="+(t||"")+o+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});