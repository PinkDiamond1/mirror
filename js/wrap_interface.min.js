var detectMetamask=!1,metamaskConnected=!1,userAddress="",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_deposit_multi="e2bbb158",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",contract_predictfee="cc4c5485",contract_getlastbalance="3303b8ab",contract_view_withdrawtoken="c650ea59",contract_calcfee="4d607fb2",contract_value="563a7956",targetNetwork=1,tokenList=[],tokenRotation=0;function loadTokenList(){multicoins=[],multicoins[0]={token:"0x6B175474E89094C44Da98b954EedeAC495271d0F",decimals:18,symbol:"DAI"},multicoins[1]={token:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",decimals:6,symbol:"USDC"},multicoins[2]={token:"0xdAC17F958D2ee523a2206206994597C13D831ec7",decimals:6,symbol:"USDT"},multicoins[3]={token:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",decimals:18,symbol:"sUSD"},tokenList.push({zToken:"0x8e769EAA31375D13a1247dE1e64987c28Bed987E",underlying:multicoins,units:"zs-USD",underlyingUnits:"USD",decimals:18,panel:"6",tokenType:2,blockFirstDeposit:11393244}),multicoins=[],multicoins[0]={token:"0x8dAEBADE922dF735c38C80C7eBD708Af50815fAa",decimals:18,symbol:"tBTC"},multicoins[1]={token:"0xfE18be6b3Bd88A2D2A7f928d00292E7a9963CfC6",decimals:18,symbol:"sBTC"},tokenList.push({zToken:"0x06C3467b2FcFc7431E92ecCE9dcb14D18bd518a2",underlying:multicoins,units:"zs-tsBTC",underlyingUnits:"BTC",decimals:18,panel:"20",tokenType:2,blockFirstDeposit:12242240}),multicoins=[],multicoins[0]={token:"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",decimals:18,symbol:"WETH"},multicoins[1]={token:"0xE95A203B1a91a908F9B9CE46459d101078c2c3cb",decimals:18,symbol:"AETH"},multicoins[2]={token:"0xae7ab96520DE3A18E5e111B5EaAb095312D7fE84",decimals:18,symbol:"STETH"},tokenList.push({zToken:"0x93B97BBb3F65EC39ea6041bF92FA998e5434E858",underlying:multicoins,units:"zs-ETH",underlyingUnits:"ETH",decimals:18,panel:"16",tokenType:2,blockFirstDeposit:11999453}),multicoins=[],multicoins[0]={token:"0xa47c8bf37f92aBed4A126BDA807A7b7498661acD",decimals:18,symbol:"UST"},multicoins[1]={token:"0xdAC17F958D2ee523a2206206994597C13D831ec7",decimals:6,symbol:"USDT"},tokenList.push({zToken:"0x27E8d93D27f55130B1870d8EF2BCE847C08A8191",underlying:"0xa47c8bf37f92aBed4A126BDA807A7b7498661acD",withdrawTokens:multicoins,units:"zs-UST",underlyingUnits:"UST",decimals:18,panel:"15",tokenType:4,maxPool:3e6,blockFirstDeposit:11939455}),multicoins=[],multicoins[0]={token:"0x674C6Ad92Fd080e4004b2312b45f796a192D27a0",decimals:18,symbol:"USDN"},multicoins[1]={token:"0xe2f2a5C287993345a840Db3B0845fbC70f5935a5",decimals:18,symbol:"MUSD"},multicoins[2]={token:"0x5BC25f649fc4e26069dDF4cF4010F9f706c23831",decimals:18,symbol:"DUSD"},multicoins[3]={token:"0x1456688345527bE1f37E9e627DA0837D6f08C925",decimals:18,symbol:"USDP"},multicoins[4]={token:"0xBC6DA0FE9aD5f3b0d58160288917AA56653660E9",decimals:18,symbol:"ALUSD"},tokenList.push({zToken:"0xB5eB7528aCB55480b4221E498834FBc8cCBCd834",underlying:multicoins,units:"zs-XUSD2",underlyingUnits:"XUSD2",decimals:18,panel:"18",tokenType:2,blockFirstDeposit:12121992}),multicoins=[],multicoins[0]={token:"0xD46bA6D942050d489DBd938a2C909A5d5039A161",decimals:9,symbol:"AMPL"},multicoins[1]={token:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",decimals:6,symbol:"USDC"},tokenList.push({zToken:"0x78172170DbD084D5EA8c24c60885C755Fc8EFA62",underlying:"0xD46bA6D942050d489DBd938a2C909A5d5039A161",underlyingStrategy:"0x8004Ea2db8D91489E261FAC0819992596Cf69077",withdrawTokens:multicoins,units:"zs-AMPL",underlyingUnits:"AMPL",decimals:18,panel:"21",tokenType:5,maxPool:1e7,blockFirstDeposit:12326653}),multicoins=[],multicoins[0]={token:"0x956F47F50A910163D8BF957Cf5846D573E7f87CA",decimals:18,symbol:"FEI"},multicoins[1]={token:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",decimals:6,symbol:"USDC"},tokenList.push({zToken:"0x544b3FF2174016949e56C370808B2C05197b4aff",underlying:"0x956F47F50A910163D8BF957Cf5846D573E7f87CA",withdrawTokens:multicoins,units:"zs-FEI",underlyingUnits:"FEI",decimals:18,panel:"19",tokenType:4,maxPool:1e7,blockFirstDeposit:12414661}),multicoins=[],multicoins[0]={token:"0x853d955aCEf822Db058eb8505911ED77F175b99e",decimals:18,symbol:"FRAX"},multicoins[1]={token:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",decimals:6,symbol:"USDC"},tokenList.push({zToken:"0xD469BB16116443F389EfEF407D73EF7Ab0Ad96Ce",underlying:"0x853d955aCEf822Db058eb8505911ED77F175b99e",withdrawTokens:multicoins,units:"zs-FRAX",underlyingUnits:"FRAX",decimals:18,panel:"14",tokenType:4,maxPool:3e6,blockFirstDeposit:-1}),multicoins=[],multicoins[0]={token:"0x36F3FD68E7325a35EB768F1AedaAe9EA0689d723",decimals:18,symbol:"ESD"},multicoins[1]={token:"0xBD2F0Cd039E0BFcf88901C98c0bFAc5ab27566e3",decimals:18,symbol:"DSD"},multicoins[2]={token:"0x3449FC1Cd036255BA1EB19d65fF4BA2b8903A69a",decimals:18,symbol:"BAC"},tokenList.push({zToken:"0xfea2468C55E80aB9487f6E6189C79Ce31E1f9Ea7",underlying:multicoins,units:"zs-SGR",underlyingUnits:"SGR",decimals:18,panel:"12",tokenType:2,maxPool:5e6,blockFirstDeposit:-1}),tokenList.push({zToken:"0x4dEaD8338cF5cb31122859b2Aec2b60416D491f0",underlying:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",units:"zpa-USDC",underlyingUnits:"USDC",decimals:6,panel:"7",tokenType:3}),tokenList.push({zToken:"0xfa8c04d342FBe24d871ea77807b1b93eC42A57ea",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"zpa-DAI",underlyingUnits:"DAI",decimals:18,panel:"8",tokenType:3}),tokenList.push({zToken:"0x6B2e59b8EbE61B5ee0EF30021b7740C63F597654",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"zpa-USDT",underlyingUnits:"USDT",decimals:6,panel:"9",tokenType:3}),tokenList.push({zToken:"0x89Cc19cece29acbD41F931F3dD61A10C1627E4c4",underlying:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",units:"zpa-sUSD",underlyingUnits:"sUSD",decimals:18,panel:"10",tokenType:3}),tokenList.push({zToken:"0x38ea93D59cc7B83DA7847E9a22eACDDc0751Af77",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"za-DAI",underlyingUnits:"DAI",decimals:18,panel:"1",tokenType:0}),tokenList.push({zToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"za-USDT",underlyingUnits:"USDT",decimals:6,panel:"2",tokenType:0})}function checkMetaMaskExist(){void 0!==window.ethereum&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect Wallet"):0==metamaskConnected&&enableMetaMask())}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){var t=await ethereum.request({method:"eth_chainId"});if(0!=(t=new BigNumber("0x"+t.substring(2))).comparedTo(targetNetwork))return void(0==t.comparedTo(56)?window.location.replace("../../"):alert("This application requires the ETH network, please switch it in your MetaMask UI."));userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function getAaveInterestRate(e){var t=tokenList[e].panel;$("#panel_"+t+"_apy").html("N/A")}async function getStrategyInterestRate(e){var t,n,o,i=tokenList[e].zToken,a=tokenList[e].blockFirstDeposit;a<0?$("#panel_"+tokenList[e].panel+"_apy").html("N/A"):0!=a&&(a=new BigNumber(a),await ethereum.request({method:"eth_blockNumber",params:[]}).then(e=>{var n=e.substring(2);t=new BigNumber("0x"+n.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),t.minus(6527).comparedTo(a)<0||(n=[{to:i,data:"0x"+contract_tokenprice},"0x"+t.toString(16)],await ethereum.request({method:"eth_call",params:n}).then(e=>{var t=e.substring(2);o=new BigNumber("0x"+t.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),n=[{to:i,data:"0x"+contract_tokenprice},"0x"+t.minus(45689).toString(16)],await ethereum.request({method:"eth_call",params:n}).then(t=>{var n=t.substring(2),i=new BigNumber("0x"+n.substring(0,64)),a=o.div(i).minus(1).div(7).times(100).times(365);a.comparedTo(1e-5)>0&&$("#panel_"+tokenList[e].panel+"_apy").html(a.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})))}function updateMultiCoinPanel(e){for(var t=$(e).attr("id"),n=-1,o=0;o<tokenList.length;o++)if("panel_"+tokenList[o].panel+"_deposit_account"==t.toLowerCase()){n=o;break}-1!=n&&($("#panel_"+tokenList[n].panel+"_action_buttons").hide(),$("#panel_"+tokenList[n].panel+"_unlock_button").hide(),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").prop("disabled",!1),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").html("UNLOCK WRAPPER"),checkAllowance(n))}function checkAllowance(e){var t=tokenList[e].panel;if(2!=tokenList[e].tokenType)var n=tokenList[e].underlying;else{var o=parseInt($("#panel_"+t+"_deposit_account").children("option:selected").val());n=tokenList[e].underlying[o].token}tokenList[e].zToken;var i=padleftzero(userAddress.substring(2),64),a=padleftzero(tokenList[e].zToken.substring(2),64);if("none"==$("#panel_"+t+"_action_buttons").css("display")&&"none"==$("#panel_"+t+"_unlock_button").css("display")||1==$("#panel_"+t+"_unlock_inner_button").prop("disabled")){const e=[{to:n,data:"0x"+contract_viewallowance+i+a},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var n=e.substring(2);new BigNumber("0x"+n.substring(0,64)).comparedTo(1)<0?$("#panel_"+t+"_unlock_button").show():($("#panel_"+t+"_unlock_button").hide(),$("#panel_"+t+"_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}}async function refreshTokenData(e){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(1==e)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var t=tokenList[tokenRotation].panel,n=tokenList[tokenRotation].zToken,o=padleftzero(userAddress.substring(2),64);checkAllowance(tokenRotation),0==tokenList[tokenRotation].tokenType||3==tokenList[tokenRotation].tokenType?getAaveInterestRate(tokenRotation):2!=tokenList[tokenRotation].tokenType&&4!=tokenList[tokenRotation].tokenType&&5!=tokenList[tokenRotation].tokenType||getStrategyInterestRate(tokenRotation);var i,a,s,r=tokenRotation,c=[{to:n,data:"0x"+contract_balanceof+o},"latest"];await ethereum.request({method:"eth_call",params:c}).then(e=>{var n=e.substring(2);i=(i=new BigNumber("0x"+n.substring(0,64))).div(new BigNumber(10).pow(tokenList[r].decimals)),a=6,i.comparedTo("0.00001")<0&&(a=10),$("#panel_"+t+"_walletbalance").html(i.dp(a).toString(10)+" "+tokenList[r].units)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),c=[{to:n,data:"0x"+contract_tokenprice},"latest"],await ethereum.request({method:"eth_call",params:c}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(10).pow(18)),$("#panel_"+t+"_price").html(o.toFormat(6)+" "+tokenList[r].underlyingUnits),s=o.times(i),$("#panel_"+t+"_value").html(s.dp(a).toString(10)+" "+tokenList[r].underlyingUnits)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),2==tokenList[tokenRotation].tokenType||4==tokenList[tokenRotation].tokenType||5==tokenList[tokenRotation].tokenType?(c=[{to:n,data:"0x"+contract_view_withdrawtoken},"latest"],await ethereum.request({method:"eth_call",params:c}).then(e=>{var n=e.substring(2).substring(0,64).toLowerCase(),o="NONE";if(2==tokenList[tokenRotation].tokenType)for(var i=0;i<tokenList[r].underlying.length;i++)n==padleftzero(tokenList[r].underlying[i].token.substring(2).toLowerCase(),64)&&(o=tokenList[r].underlying[i].symbol);else if(4==tokenList[tokenRotation].tokenType||5==tokenList[tokenRotation].tokenType)for(i=0;i<tokenList[r].withdrawTokens.length;i++)n==padleftzero(tokenList[r].withdrawTokens[i].token.substring(2).toLowerCase(),64)&&(o=tokenList[r].withdrawTokens[i].symbol);$("#panel_"+t+"_withdrawtoken").html(o),"NONE"!=o&&$("#panel_"+t+"_value").html(s.dp(a).toString(10)+" "+o)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})):3==tokenList[tokenRotation].tokenType&&(c=[{to:n,data:"0x"+contract_calcfee},"latest"],await ethereum.request({method:"eth_call",params:c}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(1e3)),$("#panel_"+t+"_fee").html(o.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})),5==tokenList[tokenRotation].tokenType&&(c=[{to:tokenList[tokenRotation].underlyingStrategy,data:"0x"+contract_predictfee},"latest"],await ethereum.request({method:"eth_call",params:c}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(1e3)),$("#panel_"+t+"_fee").html(o.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}function unlockWrapper(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber(2).pow(256).minus(1),i=tokenList[t].zToken.substring(2);i=padleftzero(i.toLowerCase(),64);var a=o.toString(16);if(a=padleftzero(a,64),2!=tokenList[t].tokenType)var s=tokenList[t].underlying;else{var r=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val());s=tokenList[t].underlying[r].token}sendETHTransaction([{to:s,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+i+a}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64),i=-1;if(2!=tokenList[t].tokenType)var a=tokenList[t].underlying;else{i=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val());a=tokenList[t].underlying[i].token}const s=[{to:a,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:s}).then(n=>{var o=n.substring(2),a=new BigNumber("0x"+o.substring(0,64)),s=tokenList[t].decimals;2==tokenList[t].tokenType?s=tokenList[t].underlying[i].decimals:4!=tokenList[t].tokenType&&5!=tokenList[t].tokenType||(s=tokenList[t].withdrawTokens[0].decimals),a=a.div(new BigNumber(10).pow(s)),$("#panel_"+e+"_amount").val(a.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxUnwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64);const i=[{to:tokenList[t].zToken,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:i}).then(n=>{var o=n.substring(2),i=new BigNumber("0x"+o.substring(0,64));i=i.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(i.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function wrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.isNaN())return;if(o.comparedTo(0)<=0)return;var i=tokenList[t].decimals,a=-1;2==tokenList[t].tokenType?(a=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val()),i=tokenList[t].underlying[a].decimals):4!=tokenList[t].tokenType&&5!=tokenList[t].tokenType||(i=tokenList[t].withdrawTokens[0].decimals);var s=(o=o.times(new BigNumber(10).pow(i))).toString(16);if(s=padleftzero(s,64),2!=tokenList[t].tokenType)var r="0x"+contract_deposit+s;else{var c=(a=new BigNumber($("#panel_"+e+"_deposit_account").children("option:selected").val())).toString(16);c=padleftzero(c,64);r="0x"+contract_deposit_multi+s+c}if(tokenList[t].maxPool){const e=[{to:tokenList[t].zToken,data:"0x"+contract_value},"latest"];return void ethereum.request({method:"eth_call",params:e}).then(e=>{var n=e.substring(2),a=new BigNumber("0x"+n.substring(0,64));a=a.div(new BigNumber(10).pow(18));var s=o.div(new BigNumber(10).pow(i));if(a.plus(s).comparedTo(tokenList[t].maxPool)>0){var c=new BigNumber(tokenList[t].maxPool).minus(a);c.comparedTo(0)<0&&(c=new BigNumber(0)),alert("This wrap amount is greater than the limit, which is: "+c.dp(2).toString(10)+" tokens")}else{sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:r}],null)}}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:r}],null)}function unwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.isNaN())return;if(o.comparedTo(0)<=0)return;var i=(o=o.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);i=padleftzero(i,64),sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:"0x"+contract_redeem+i}],null)}async function sendETHTransaction(e,t){var n=await ethereum.request({method:"eth_chainId"});0==(n=new BigNumber("0x"+n.substring(2))).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,n){var o="";if(n>0){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),o="; expires="+i.toUTCString()}document.cookie=e+"="+(t||"")+o+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});