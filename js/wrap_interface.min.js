var detectMetamask=!1,metamaskConnected=!1,userAddress="",aave_lending_pool_core="0x3dfd23A6c5E8BbcFc9581d2E864a68feb6a076d3",contract_getrate="c540148e",contract_getratio="ec1ebd7a",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_deposit_multi="e2bbb158",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",contract_view_withdrawtoken="c650ea59",contract_calcfee="4d607fb2",targetNetwork=1,tokenList=[],tokenRotation=0;function loadTokenList(){tokenList.push({zToken:"0x4dEaD8338cF5cb31122859b2Aec2b60416D491f0",underlying:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",units:"zpa-USDC",underlyingUnits:"USDC",decimals:6,panel:"7",tokenType:3}),tokenList.push({zToken:"0xfa8c04d342FBe24d871ea77807b1b93eC42A57ea",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"zpa-DAI",underlyingUnits:"DAI",decimals:18,panel:"8",tokenType:3}),tokenList.push({zToken:"0x6B2e59b8EbE61B5ee0EF30021b7740C63F597654",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"zpa-USDT",underlyingUnits:"USDT",decimals:6,panel:"9",tokenType:3}),tokenList.push({zToken:"0x89Cc19cece29acbD41F931F3dD61A10C1627E4c4",underlying:"0x57Ab1ec28D129707052df4dF418D58a2D46d5f51",units:"zpa-sUSD",underlyingUnits:"sUSD",decimals:18,panel:"10",tokenType:3});var e=[];e[0]="0x6B175474E89094C44Da98b954EedeAC495271d0F",e[1]="0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",e[2]="0xdAC17F958D2ee523a2206206994597C13D831ec7",e[3]="0x57Ab1ec28D129707052df4dF418D58a2D46d5f51";var t=[];t[0]=18,t[1]=6,t[2]=6,t[3]=18,tokenList.push({zToken:"0x8e769EAA31375D13a1247dE1e64987c28Bed987E",underlying:e,units:"zs-USD",underlyingUnits:"USD",decimals:18,underlyingDecimals:t,panel:"6",tokenType:2}),(e=[])[0]="0xEB4C2781e4ebA804CE9a9803C67d0893436bB27D",e[1]="0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",e[2]="0xfE18be6b3Bd88A2D2A7f928d00292E7a9963CfC6",(t=[])[0]=8,t[1]=8,t[2]=18,tokenList.push({zToken:"0x739D93f2b116E6aD754e173655c635Bd5D8d664c",underlying:e,units:"zs-BTC",underlyingUnits:"BTC",decimals:18,underlyingDecimals:t,panel:"11",tokenType:2}),(e=[])[0]="0x36F3FD68E7325a35EB768F1AedaAe9EA0689d723",e[1]="0xBD2F0Cd039E0BFcf88901C98c0bFAc5ab27566e3",e[2]="0x3449FC1Cd036255BA1EB19d65fF4BA2b8903A69a",(t=[])[0]=18,t[1]=18,t[2]=18,tokenList.push({zToken:"0xfea2468C55E80aB9487f6E6189C79Ce31E1f9Ea7",underlying:e,units:"zs-SGR",underlyingUnits:"SGR",decimals:18,underlyingDecimals:t,panel:"12",tokenType:2}),tokenList.push({zToken:"0x38ea93D59cc7B83DA7847E9a22eACDDc0751Af77",underlying:"0x6B175474E89094C44Da98b954EedeAC495271d0F",units:"za-DAI",underlyingUnits:"DAI",decimals:18,panel:"1",tokenType:0}),tokenList.push({zToken:"0xd1C790B9B2Ac49639f99a88B0a5991dFa6cD2C14",underlying:"0xdAC17F958D2ee523a2206206994597C13D831ec7",units:"za-USDT",underlyingUnits:"USDT",decimals:6,panel:"2",tokenType:0})}function checkMetaMaskExist(){void 0!==window.ethereum&&(1==ethereum.isMetaMask&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect MetaMask"):0==metamaskConnected&&enableMetaMask()))}async function enableMetaMask(){const e=await ethereum.request({method:"eth_requestAccounts"});if(e){if(ethereum.chainId||(ethereum.chainId="0x1"),0!=new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork))return void alert("This application requires the main network, please switch it in your MetaMask UI.");userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){if(0==detectMetamask)window.open("https://metamask.io/","_blank");else 1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function getAaveInterestRate(e){var t=tokenList[e].panel,n=padleftzero(tokenList[e].underlying.substring(2),64);const o=[{to:aave_lending_pool_core,data:"0x"+contract_getrate+n},"latest"];ethereum.request({method:"eth_call",params:o}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(10).pow(25)),$("#panel_"+t+"_apy").html(o.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function getMultiCoinInterestRate(e){var t,n=tokenList[e].zToken;"zs-USD"==tokenList[e].units?t=new BigNumber(11393244):"zs-BTC"==tokenList[e].units?t=new BigNumber(11441662):"zs-SGR"==tokenList[e].units&&(t=new BigNumber(11564062)),ethereum.request({method:"eth_blockNumber",params:[]}).then(o=>{var a=o.substring(2),i=new BigNumber("0x"+a.substring(0,64));const r=[{to:n,data:"0x"+contract_tokenprice},"0x"+i.toString(16)];ethereum.request({method:"eth_call",params:r}).then(n=>{var o=n.substring(2),a=new BigNumber("0x"+o.substring(0,64)),r=new BigNumber(10).pow(18),s=a.div(r).minus(1),c=i.minus(t).div(6527);0==c.comparedTo(0)&&(c=new BigNumber(1));var l=s.div(c).times(100).times(365);$("#panel_"+tokenList[e].panel+"_apy").html(l.dp(4).toString(10)+"%")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function updateMultiCoinPanel(e){for(var t=$(e).attr("id"),n=-1,o=0;o<tokenList.length;o++)if("panel_"+tokenList[o].panel+"_deposit_account"==t.toLowerCase()){n=o;break}-1!=n&&($("#panel_"+tokenList[n].panel+"_action_buttons").hide(),$("#panel_"+tokenList[n].panel+"_unlock_button").hide(),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").prop("disabled",!1),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").html("UNLOCK WRAPPER"),checkAllowance(n))}function checkAllowance(e){var t=tokenList[e].panel;if(2!=tokenList[e].tokenType)var n=tokenList[e].underlying;else{var o=parseInt($("#panel_"+t+"_deposit_account").children("option:selected").val());n=tokenList[e].underlying[o]}tokenList[e].zToken;var a=padleftzero(userAddress.substring(2),64),i=padleftzero(tokenList[e].zToken.substring(2),64);if("none"==$("#panel_"+t+"_action_buttons").css("display")&&"none"==$("#panel_"+t+"_unlock_button").css("display")||1==$("#panel_"+t+"_unlock_inner_button").prop("disabled")){const e=[{to:n,data:"0x"+contract_viewallowance+a+i},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var n=e.substring(2);new BigNumber("0x"+n.substring(0,64)).comparedTo(1)<0?$("#panel_"+t+"_unlock_button").show():($("#panel_"+t+"_unlock_button").hide(),$("#panel_"+t+"_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}}function refreshTokenData(e){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(1==e)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var t=tokenList[tokenRotation].panel,n=tokenList[tokenRotation].zToken,o=padleftzero(userAddress.substring(2),64);checkAllowance(tokenRotation),0==tokenList[tokenRotation].tokenType||3==tokenList[tokenRotation].tokenType?getAaveInterestRate(tokenRotation):2==tokenList[tokenRotation].tokenType&&getMultiCoinInterestRate(tokenRotation);var a=tokenRotation;const i=[{to:n,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:i}).then(e=>{var o=e.substring(2),i=new BigNumber("0x"+o.substring(0,64));i=i.div(new BigNumber(10).pow(tokenList[a].decimals));var r=6;i.comparedTo("0.00001")<0&&(r=10),$("#panel_"+t+"_walletbalance").html(i.dp(r).toString(10)+" "+tokenList[a].units);const s=[{to:n,data:"0x"+contract_tokenprice},"latest"];ethereum.request({method:"eth_call",params:s}).then(e=>{var o=e.substring(2),s=new BigNumber("0x"+o.substring(0,64));s=s.div(new BigNumber(10).pow(18)),$("#panel_"+t+"_price").html(s.toFormat(6)+" "+tokenList[a].underlyingUnits);var c=s.times(i);if($("#panel_"+t+"_value").html(c.dp(r).toString(10)+" "+tokenList[a].underlyingUnits),0==tokenList[tokenRotation].tokenType||1==tokenList[tokenRotation].tokenType)++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500);else if(2==tokenList[tokenRotation].tokenType){const e=[{to:n,data:"0x"+contract_view_withdrawtoken},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{for(var n=e.substring(2).substring(0,64).toLowerCase(),o=-1,i=0;i<tokenList[a].underlying.length;i++)n==padleftzero(tokenList[a].underlying[i].substring(2).toLowerCase(),64)&&(o=i);var r="NONE";"zs-USD"==tokenList[a].units?0==o?r="DAI":1==o?r="USDC":2==o?r="USDT":3==o&&(r="sUSD"):"zs-BTC"==tokenList[a].units?0==o?r="renBTC":1==o?r="wBTC":2==o&&(r="sBTC"):"zs-SGR"==tokenList[a].units&&(0==o?r="ESD":1==o?r="DSD":2==o&&(r="BAC")),$("#panel_"+t+"_withdrawtoken").html(r),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}else if(3==tokenList[tokenRotation].tokenType){const e=[{to:n,data:"0x"+contract_calcfee},"latest"];ethereum.request({method:"eth_call",params:e}).then(e=>{var n=e.substring(2),o=new BigNumber("0x"+n.substring(0,64));o=o.div(new BigNumber(1e3)),$("#panel_"+t+"_fee").html(o.dp(4).toString(10)+"%"),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function unlockWrapper(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber(2).pow(256).minus(1),a=tokenList[t].zToken.substring(2);a=padleftzero(a,64);var i=o.toString(16);if(i=padleftzero(i,64),2!=tokenList[t].tokenType)var r=tokenList[t].underlying;else{var s=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val());r=tokenList[t].underlying[s]}sendETHTransaction([{to:r,gas:"0x186A0",from:userAddress,data:"0x"+contract_approve+a+i}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64),a=-1;if(2!=tokenList[t].tokenType)var i=tokenList[t].underlying;else{a=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val());i=tokenList[t].underlying[a]}const r=[{to:i,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:r}).then(n=>{var o=n.substring(2),i=new BigNumber("0x"+o.substring(0,64)),r=tokenList[t].decimals;2==tokenList[t].tokenType&&(r=tokenList[t].underlyingDecimals[a]),i=i.div(new BigNumber(10).pow(r)),$("#panel_"+e+"_amount").val(i.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxUnwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=padleftzero(userAddress.substring(2),64);const a=[{to:tokenList[t].zToken,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:a}).then(n=>{var o=n.substring(2),a=new BigNumber("0x"+o.substring(0,64));a=a.div(new BigNumber(10).pow(tokenList[t].decimals)),$("#panel_"+e+"_amount").val(a.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function wrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.isNaN())return;if(o.comparedTo(0)<=0)return;var a=tokenList[t].decimals,i=-1;2==tokenList[t].tokenType&&(i=parseInt($("#panel_"+e+"_deposit_account").children("option:selected").val()),a=tokenList[t].underlyingDecimals[i]);var r=(o=o.times(new BigNumber(10).pow(a))).toString(16);if(r=padleftzero(r,64),2!=tokenList[t].tokenType)var s="0x"+contract_deposit+r;else{var c=(i=new BigNumber($("#panel_"+e+"_deposit_account").children("option:selected").val())).toString(16);c=padleftzero(c,64);s="0x"+contract_deposit_multi+r+c}sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:s}],null)}function unwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(o.isNaN())return;if(o.comparedTo(0)<=0)return;var a=(o=o.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16);a=padleftzero(a,64),sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:"0x"+contract_redeem+a}],null)}function sendETHTransaction(e,t){0==new BigNumber("0x"+ethereum.chainId.substring(2)).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,n){var o="";if(n>0){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3),o="; expires="+a.toUTCString()}document.cookie=e+"="+(t||"")+o+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}$(window).on("load",function(){checkMetaMaskExist()});